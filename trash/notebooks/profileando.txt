GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name      | Type            | Params
----------------------------------------------
0 | pool      | MaxPool2d       | 0     
1 | conv1     | Conv2d          | 320   
2 | conv2     | Conv2d          | 9.2 K 
3 | conv3     | Conv2d          | 9.2 K 
4 | fc1       | Linear          | 322 K 
5 | fc2       | Linear          | 10.2 K
6 | fc3       | Linear          | 680   
7 | accuracy  | Accuracy        | 0     
8 | confusion | ConfusionMatrix | 0     
----------------------------------------------
352 K     Trainable params
0         Non-trainable params
352 K     Total params
1.409     Total estimated model params size (MB)
/home/margarcuae/.local/lib/python3.8/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:617: UserWarning: Checkpoint directory /home/margarcuae/Documentos/luis/ser-framewework/notebooks/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
FIT Profiler Report
Profile stats for: prepare_data
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1597(training_type_plugin)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 hooks.py:325(prepare_data)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: configure_callbacks
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1597(training_type_plugin)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 lightning.py:1209(configure_callbacks)
        1    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_before_accelerator_backend_setup
         46 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:35(on_before_accelerator_backend_setup)
        3    0.000    0.000    0.000    0.000 trainer.py:1668(lightning_module)
        3    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        3    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        6    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        3    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        4    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
        1    0.000    0.000    0.000    0.000 trainer.py:1597(training_type_plugin)
        3    0.000    0.000    0.000    0.000 base.py:63(on_before_accelerator_backend_setup)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: setup
         42 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:45(setup)
        3    0.000    0.000    0.000    0.000 trainer.py:1668(lightning_module)
        3    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        3    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        3    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        3    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
        3    0.000    0.000    0.000    0.000 base.py:67(setup)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 hooks.py:373(setup)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: configure_sharded_model
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1597(training_type_plugin)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 hooks.py:298(configure_sharded_model)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_configure_sharded_model
         46 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:40(on_configure_sharded_model)
        3    0.000    0.000    0.000    0.000 trainer.py:1668(lightning_module)
        3    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        3    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        6    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        3    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        4    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
        1    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1597(training_type_plugin)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        3    0.000    0.000    0.000    0.000 base.py:60(on_configure_sharded_model)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: configure_optimizers
         439 function calls (421 primitive calls) in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 cnn.py:58(configure_optimizers)
        1    0.000    0.000    0.000    0.000 adam.py:60(__init__)
        1    0.000    0.000    0.000    0.000 optimizer.py:33(__init__)
       13    0.000    0.000    0.000    0.000 module.py:1499(parameters)
       13    0.000    0.000    0.000    0.000 module.py:1523(named_parameters)
       13    0.000    0.000    0.000    0.000 module.py:1486(_named_members)
    29/11    0.000    0.000    0.000    0.000 module.py:1653(named_modules)
        1    0.000    0.000    0.000    0.000 optimizer.py:232(add_param_group)
        4    0.000    0.000    0.000    0.000 metric.py:560(__hash__)
       62    0.000    0.000    0.000    0.000 _tensor.py:650(__hash__)
        1    0.000    0.000    0.000    0.000 optimizer.py:78(_hook_for_profile)
       22    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.000    0.000 optimizer.py:81(profile_hook_step)
        1    0.000    0.000    0.000    0.000 functools.py:34(update_wrapper)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.hash}
       24    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
       10    0.000    0.000    0.000    0.000 module.py:1544(<lambda>)
       62    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
       31    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       66    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       15    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       15    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
       20    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 functools.py:64(wraps)
        5    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.setattr}
        1    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1597(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_fit_start
         45 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:65(on_fit_start)
        3    0.000    0.000    0.000    0.000 trainer.py:1668(lightning_module)
        3    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        3    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        3    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        4    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
        1    0.000    0.000    0.000    0.000 trainer.py:1597(training_type_plugin)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        3    0.000    0.000    0.000    0.000 base.py:83(on_fit_start)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:28(on_fit_start)



Profile stats for: on_pretrain_routine_start
         2401 function calls (2347 primitive calls) in 0.002 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.002    0.002 callback_hook.py:145(on_pretrain_routine_start)
        1    0.000    0.000    0.001    0.001 model_summary.py:52(on_pretrain_routine_start)
       13    0.000    0.000    0.001    0.000 {built-in method builtins.sum}
        1    0.000    0.000    0.000    0.000 model_summary.py:300(_get_summary_data)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:265(on_pretrain_routine_start)
        1    0.000    0.000    0.000    0.000 model_summary.py:244(param_nums)
        1    0.000    0.000    0.000    0.000 model_summary.py:246(<listcomp>)
        9    0.000    0.000    0.000    0.000 model_summary.py:122(num_parameters)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:615(__warn_if_dir_not_empty)
       60    0.000    0.000    0.000    0.000 module.py:1499(parameters)
       21    0.000    0.000    0.000    0.000 model_summary.py:125(<genexpr>)
       60    0.000    0.000    0.000    0.000 module.py:1523(named_parameters)
       60    0.000    0.000    0.000    0.000 module.py:1486(_named_members)
        1    0.000    0.000    0.000    0.000 distributed.py:46(wrapped_fn)
        1    0.000    0.000    0.000    0.000 warnings.py:25(rank_zero_warn)
        1    0.000    0.000    0.000    0.000 warnings.py:21(_warn)
        1    0.000    0.000    0.000    0.000 {built-in method _warnings.warn}
        1    0.000    0.000    0.000    0.000 model_summary.py:65(summarize)
        1    0.000    0.000    0.000    0.000 warnings.py:96(_showwarnmsg)
        1    0.000    0.000    0.000    0.000 warnings.py:20(_showwarnmsg_impl)
        1    0.000    0.000    0.000    0.000 warnings.py:117(_formatwarnmsg)
        1    0.000    0.000    0.000    0.000 warnings.py:35(_formatwarnmsg_impl)
        1    0.000    0.000    0.000    0.000 linecache.py:15(getline)
        1    0.000    0.000    0.000    0.000 linecache.py:37(getlines)
        1    0.000    0.000    0.000    0.000 linecache.py:82(updatecache)
        2    0.000    0.000    0.000    0.000 model_summary.py:248(total_parameters)
       26    0.000    0.000    0.000    0.000 model_summary.py:250(<genexpr>)
       12    0.000    0.000    0.000    0.000 <__array_function__ internals>:2(prod)
       12    0.000    0.000    0.000    0.000 {built-in method numpy.core._multiarray_umath.implement_array_function}
   105/51    0.000    0.000    0.000    0.000 module.py:1653(named_modules)
       12    0.000    0.000    0.000    0.000 fromnumeric.py:2792(prod)
       12    0.000    0.000    0.000    0.000 fromnumeric.py:73(_wrapreduction)
        1    0.000    0.000    0.000    0.000 model_summary.py:439(summarize)
        1    0.000    0.000    0.000    0.000 __init__.py:1436(info)
       20    0.000    0.000    0.000    0.000 metric.py:560(__hash__)
        1    0.000    0.000    0.000    0.000 model_summary.py:189(__init__)
        1    0.000    0.000    0.000    0.000 model_summary.py:263(summarize)
        1    0.000    0.000    0.000    0.000 __init__.py:1565(_log)
       12    0.000    0.000    0.000    0.000 model_summary.py:389(get_human_readable_count)
       12    0.000    0.000    0.000    0.000 {method 'reduce' of 'numpy.ufunc' objects}
        1    0.000    0.000    0.000    0.000 model_summary.py:341(_format_summary_table)
        1    0.000    0.000    0.000    0.000 model_summary.py:252(trainable_parameters)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:576(__resolve_ckpt_dir)
       13    0.000    0.000    0.000    0.000 model_summary.py:254(<genexpr>)
       96    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.000    0.000 model_summary.py:258(model_size)
        1    0.000    0.000    0.000    0.000 {method 'readlines' of '_io._IOBase' objects}
        1    0.000    0.000    0.000    0.000 tokenize.py:388(open)
      166    0.000    0.000    0.000    0.000 _tensor.py:650(__hash__)
        1    0.000    0.000    0.000    0.000 __init__.py:1591(handle)
        1    0.000    0.000    0.000    0.000 __init__.py:1645(callHandlers)
        1    0.000    0.000    0.000    0.000 local.py:53(ls)
        1    0.000    0.000    0.000    0.000 __init__.py:941(handle)
        1    0.000    0.000    0.000    0.000 __init__.py:1073(emit)
       48    0.000    0.000    0.000    0.000 model_summary.py:426(_is_lazy_weight_tensor)
        1    0.000    0.000    0.000    0.000 local.py:45(makedirs)
       10    0.000    0.000    0.000    0.000 model_summary.py:264(<genexpr>)
        1    0.000    0.000    0.000    0.000 __init__.py:1062(flush)
        1    0.000    0.000    0.000    0.000 model_summary.py:215(named_modules)
        1    0.000    0.000    0.000    0.000 os.py:198(makedirs)
        9    0.000    0.000    0.000    0.000 model_summary.py:68(__init__)
        1    0.000    0.000    0.000    0.000 tokenize.py:295(detect_encoding)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.hash}
        1    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
       10    0.000    0.000    0.000    0.000 module.py:1606(named_children)
        1    0.000    0.000    0.000    0.000 local.py:59(<listcomp>)
       18    0.000    0.000    0.000    0.000 posixpath.py:71(join)
        9    0.000    0.000    0.000    0.000 model_summary.py:78(_register_hook)
        1    0.000    0.000    0.000    0.000 __init__.py:1550(makeRecord)
        1    0.000    0.000    0.000    0.000 trainer.py:1847(weights_save_path)
        1    0.000    0.000    0.000    0.000 __init__.py:288(__init__)
        4    0.000    0.000    0.000    0.000 {built-in method posix.stat}
        1    0.000    0.000    0.000    0.000 {built-in method posix.listdir}
      165    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 cloud_io.py:41(get_filesystem)
        1    0.000    0.000    0.000    0.000 spec.py:61(__call__)
        9    0.000    0.000    0.000    0.000 module.py:1053(register_forward_hook)
        1    0.000    0.000    0.000    0.000 genericpath.py:16(exists)
        8    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        1    0.000    0.000    0.000    0.000 spec.py:643(isdir)
        1    0.000    0.000    0.000    0.000 {built-in method io.open}
       88    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 local.py:65(info)
      186    0.000    0.000    0.000    0.000 {built-in method builtins.id}
       44    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
      166    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
       39    0.000    0.000    0.000    0.000 module.py:1544(<lambda>)
       18    0.000    0.000    0.000    0.000 model_summary.py:101(detach_hook)
        3    0.000    0.000    0.000    0.000 trainer.py:1668(lightning_module)
        2    0.000    0.000    0.000    0.000 tokenize.py:319(read_or_stop)
        1    0.000    0.000    0.000    0.000 __init__.py:918(format)
        3    0.000    0.000    0.000    0.000 local.py:182(_strip_protocol)
       40    0.000    0.000    0.000    0.000 model_summary.py:355(<genexpr>)
      116    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        1    0.000    0.000    0.000    0.000 __init__.py:655(format)
        6    0.000    0.000    0.000    0.000 codecs.py:319(decode)
        2    0.000    0.000    0.000    0.000 {method 'readline' of '_io.BufferedReader' objects}
        1    0.000    0.000    0.000    0.000 __init__.py:1689(isEnabledFor)
        1    0.000    0.000    0.000    0.000 {built-in method posix.mkdir}
        3    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 __init__.py:1514(findCaller)
        9    0.000    0.000    0.000    0.000 hooks.py:15(__init__)
       79    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        9    0.000    0.000    0.000    0.000 model_summary.py:75(__del__)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 utils.py:271(tokenize)
        1    0.000    0.000    0.000    0.000 posixpath.py:334(normpath)
       74    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        3    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        2    0.000    0.000    0.000    0.000 tokenize.py:325(find_cookie)
       18    0.000    0.000    0.000    0.000 hooks.py:20(remove)
        1    0.000    0.000    0.000    0.000 model_summary.py:232(layer_types)
        1    0.000    0.000    0.000    0.000 model_summary.py:362(<listcomp>)
       36    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 genericpath.py:39(isdir)
       20    0.000    0.000    0.000    0.000 posixpath.py:41(_get_sep)
        1    0.000    0.000    0.000    0.000 model_summary.py:272(<listcomp>)
        1    0.000    0.000    0.000    0.000 model_summary.py:234(<listcomp>)
       12    0.000    0.000    0.000    0.000 fromnumeric.py:74(<dictcomp>)
        6    0.000    0.000    0.000    0.000 {built-in method _codecs.utf_8_decode}
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 posixpath.py:140(basename)
        2    0.000    0.000    0.000    0.000 trainer.py:1759(is_global_zero)
       58    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 posixpath.py:117(splitext)
        3    0.000    0.000    0.000    0.000 {method 'match' of 're.Pattern' objects}
       27    0.000    0.000    0.000    0.000 {method 'startswith' of 'str' objects}
        3    0.000    0.000    0.000    0.000 local.py:200(make_path_posix)
        1    0.000    0.000    0.000    0.000 posixpath.py:100(split)
        1    0.000    0.000    0.000    0.000 config.py:66(apply_config)
        1    0.000    0.000    0.000    0.000 __init__.py:633(usesTime)
       12    0.000    0.000    0.000    0.000 {built-in method builtins.min}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        5    0.000    0.000    0.000    0.000 trainer.py:1597(training_type_plugin)
        9    0.000    0.000    0.000    0.000 model_summary.py:117(layer_type)
        1    0.000    0.000    0.000    0.000 warnings.py:403(__init__)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 __init__.py:639(formatMessage)
       19    0.000    0.000    0.000    0.000 {method 'endswith' of 'str' objects}
        1    0.000    0.000    0.000    0.000 __init__.py:218(_acquireLock)
        2    0.000    0.000    0.000    0.000 trainer.py:1605(global_rank)
        3    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)
        9    0.000    0.000    0.000    0.000 {method 'count' of 'str' objects}
        2    0.000    0.000    0.000    0.000 __init__.py:898(acquire)
        1    0.000    0.000    0.000    0.000 codecs.py:309(__init__)
        1    0.000    0.000    0.000    0.000 __init__.py:160(<lambda>)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 model_summary.py:228(layer_names)
        1    0.000    0.000    0.000    0.000 __init__.py:438(format)
        1    0.000    0.000    0.000    0.000 genericpath.py:121(_splitext)
        8    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
       23    0.000    0.000    0.000    0.000 {built-in method posix.fspath}
       11    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
        1    0.000    0.000    0.000    0.000 __init__.py:119(getLevelName)
        1    0.000    0.000    0.000    0.000 __init__.py:427(usesTime)
       12    0.000    0.000    0.000    0.000 fromnumeric.py:2787(_prod_dispatcher)
       12    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
        1    0.000    0.000    0.000    0.000 __init__.py:435(_format)
        3    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        2    0.000    0.000    0.000    0.000 __init__.py:905(release)
        1    0.000    0.000    0.000    0.000 __init__.py:227(_releaseLock)
        3    0.000    0.000    0.000    0.000 utils.py:287(stringify_path)
        1    0.000    0.000    0.000    0.000 {built-in method _hashlib.openssl_md5}
        1    0.000    0.000    0.000    0.000 model_summary.py:385(get_formatted_model_size)
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        1    0.000    0.000    0.000    0.000 posixpath.py:52(normcase)
        1    0.000    0.000    0.000    0.000 threading.py:1306(current_thread)
        4    0.000    0.000    0.000    0.000 {method 'rfind' of 'str' objects}
        3    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:326(should_rank_save_checkpoint)
        1    0.000    0.000    0.000    0.000 {method 'hexdigest' of '_hashlib.HASH' objects}
        2    0.000    0.000    0.000    0.000 __init__.py:796(filter)
        2    0.000    0.000    0.000    0.000 lightning.py:184(example_input_array)
        1    0.000    0.000    0.000    0.000 __init__.py:1675(getEffectiveLevel)
        3    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        4    0.000    0.000    0.000    0.000 {method 'rstrip' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'seek' of '_io.BufferedReader' objects}
        1    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'startswith' of 'bytes' objects}
        1    0.000    0.000    0.000    0.000 __init__.py:364(getMessage)
        2    0.000    0.000    0.000    0.000 {method 'decode' of 'bytes' objects}
        1    0.000    0.000    0.000    0.000 threading.py:1031(name)
        1    0.000    0.000    0.000    0.000 codecs.py:260(__init__)
        1    0.000    0.000    0.000    0.000 {built-in method time.time}
        2    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 process.py:189(name)
        3    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
        1    0.000    0.000    0.000    0.000 {method 'strip' of 'str' objects}
        2    0.000    0.000    0.000    0.000 {built-in method _stat.S_ISDIR}
        1    0.000    0.000    0.000    0.000 {method 'find' of 'str' objects}
        1    0.000    0.000    0.000    0.000 process.py:37(current_process)
        1    0.000    0.000    0.000    0.000 __init__.py:1276(disable)
        3    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {built-in method sys._getframe}
        1    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
        1    0.000    0.000    0.000    0.000 single_device.py:73(is_global_zero)
        1    0.000    0.000    0.000    0.000 hooks.py:64(on_pretrain_routine_start)
        1    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 base.py:238(on_pretrain_routine_start)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 spec.py:63(<genexpr>)
        1    0.000    0.000    0.000    0.000 {built-in method _stat.S_ISLNK}
        1    0.000    0.000    0.000    0.000 {method 'keys' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 single_device.py:80(broadcast)



Profile stats for: on_pretrain_routine_end
         45 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:150(on_pretrain_routine_end)
        3    0.000    0.000    0.000    0.000 trainer.py:1668(lightning_module)
        3    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        3    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        3    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        4    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
        1    0.000    0.000    0.000    0.000 trainer.py:1597(training_type_plugin)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        3    0.000    0.000    0.000    0.000 base.py:242(on_pretrain_routine_end)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:73(on_pretrain_routine_end)



Profile stats for: on_train_dataloader
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1597(training_type_plugin)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 hooks.py:620(on_train_dataloader)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_start
         54 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:135(on_train_start)
        3    0.000    0.000    0.000    0.000 trainer.py:1668(lightning_module)
        1    0.000    0.000    0.000    0.000 gpu.py:48(on_train_start)
        3    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        3    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 memory.py:102(empty_cache)
        3    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:271(on_train_start)
        1    0.000    0.000    0.000    0.000 __init__.py:146(is_initialized)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 accelerator.py:568(on_train_start)
        5    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_emptyCache}
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_isInBadFork}
        1    0.000    0.000    0.000    0.000 {built-in method time.monotonic}
        2    0.000    0.000    0.000    0.000 base.py:230(on_train_start)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:331(on_train_start)
        1    0.000    0.000    0.000    0.000 hooks.py:40(on_train_start)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: run_training_epoch
         8100 function calls in 57.706 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      180    0.000    0.000   57.706    0.321 base.py:109(run)
      180    0.000    0.000   57.702    0.321 training_epoch_loop.py:133(on_run_start)
      180    0.001    0.000   57.702    0.321 trainer.py:1463(call_hook)
      180    0.000    0.000   57.700    0.321 contextlib.py:108(__enter__)
      180    0.000    0.000   57.700    0.321 {built-in method builtins.next}
      180    0.000    0.000   57.700    0.321 base.py:68(profile)
      180    0.000    0.000   57.700    0.321 advanced.py:61(start)
      180   57.699    0.321   57.699    0.321 {method 'enable' of '_lsprof.Profiler' objects}
      180    0.001    0.000    0.003    0.000 training_epoch_loop.py:118(reset)
      720    0.000    0.000    0.001    0.000 progress.py:154(reset_on_run)
      180    0.000    0.000    0.001    0.000 progress.py:194(reset_on_run)
      180    0.000    0.000    0.001    0.000 trainer.py:1668(lightning_module)
      180    0.000    0.000    0.001    0.000 progress.py:263(reset_on_run)
      180    0.000    0.000    0.001    0.000 module.py:1180(__setattr__)
      180    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
      180    0.000    0.000    0.001    0.000 progress.py:101(reset)
      180    0.000    0.000    0.001    0.000 progress.py:230(reset_on_run)
      180    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
      360    0.000    0.000    0.000    0.000 progress.py:77(reset)
      180    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
      720    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      180    0.000    0.000    0.000    0.000 contextlib.py:238(helper)
      720    0.000    0.000    0.000    0.000 progress.py:49(reset)
      180    0.000    0.000    0.000    0.000 contextlib.py:82(__init__)
      180    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)
      180    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
      180    0.000    0.000    0.000    0.000 logger_connector.py:264(on_epoch_start)
      360    0.000    0.000    0.000    0.000 base.py:54(trainer)
      540    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      180    0.000    0.000    0.000    0.000 base.py:84(skip)
      180    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
      180    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}



Profile stats for: on_epoch_start
         8100 function calls in 0.003 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      180    0.001    0.000    0.002    0.000 callback_hook.py:125(on_epoch_start)
      540    0.000    0.000    0.001    0.000 trainer.py:1668(lightning_module)
      540    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
      540    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
      540    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
     1080    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      180    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
      180    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      180    0.000    0.000    0.000    0.000 base.py:68(profile)
      540    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)
      180    0.000    0.000    0.000    0.000 advanced.py:66(stop)
      540    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
      360    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      720    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
      180    0.000    0.000    0.000    0.000 trainer.py:1597(training_type_plugin)
      540    0.000    0.000    0.000    0.000 base.py:160(on_epoch_start)
      180    0.000    0.000    0.000    0.000 hooks.py:184(on_epoch_start)
      360    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
      180    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      180    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      180    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_epoch_start
         8820 function calls in 0.003 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      180    0.000    0.000    0.002    0.000 callback_hook.py:85(on_train_epoch_start)
      540    0.000    0.000    0.001    0.000 trainer.py:1668(lightning_module)
      540    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
      540    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
      180    0.000    0.000    0.001    0.000 gradient_accumulation_scheduler.py:102(on_train_epoch_start)
      540    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
     1080    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      180    0.000    0.000    0.000    0.000 trainer.py:2023(current_epoch)
      180    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
      180    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      180    0.000    0.000    0.000    0.000 gradient_accumulation_scheduler.py:94(get_accumulate_grad_batches)
      540    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)
      180    0.000    0.000    0.000    0.000 trainer.py:2047(fit_loop)
      180    0.000    0.000    0.000    0.000 base.py:68(profile)
      360    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      180    0.000    0.000    0.000    0.000 advanced.py:66(stop)
      540    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
      720    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
      180    0.000    0.000    0.000    0.000 trainer.py:1597(training_type_plugin)
      180    0.000    0.000    0.000    0.000 fit_loop.py:55(current_epoch)
      360    0.000    0.000    0.000    0.000 base.py:122(on_train_epoch_start)
      180    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      360    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
      180    0.000    0.000    0.000    0.000 hooks.py:190(on_train_epoch_start)
      180    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      180    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: get_train_batch
         37800 function calls (34200 primitive calls) in 10.956 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
5400/3600    0.002    0.000   10.950    0.003 contextlib.py:108(__enter__)
5400/3600    0.001    0.000   10.949    0.003 {built-in method builtins.next}
     1800    0.001    0.000   10.947    0.006 fetching.py:287(apply_profiler)
     1800    0.001    0.000   10.944    0.006 base.py:68(profile)
     1800    0.001    0.000   10.943    0.006 advanced.py:61(start)
     1800   10.942    0.006   10.942    0.006 {method 'enable' of '_lsprof.Profiler' objects}
     5400    0.002    0.000    0.007    0.000 contextlib.py:238(helper)
     5400    0.004    0.000    0.005    0.000 contextlib.py:82(__init__)
     5400    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
     1800    0.000    0.000    0.000    0.000 fetching.py:238(fetching_context)
     1800    0.000    0.000    0.000    0.000 fetching.py:243(on_fetch_start)



Profile stats for: fetch_next_train_batch
         275136 function calls (267576 primitive calls) in 10.928 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
9000/3420    0.005    0.000   10.926    0.003 {built-in method builtins.next}
     1800    0.003    0.000   10.919    0.006 supporters.py:530(__next__)
     1800    0.002    0.000   10.915    0.006 supporters.py:538(request_next_batch)
     1800    0.002    0.000   10.913    0.006 apply_func.py:66(apply_to_collection)
     1800    0.012    0.000   10.905    0.006 dataloader.py:517(__next__)
     1800    0.011    0.000   10.766    0.006 dataloader.py:1156(_next_data)
     1620    0.004    0.000   10.700    0.007 dataloader.py:1123(_get_data)
     1620    0.003    0.000   10.691    0.007 dataloader.py:977(_try_get_data)
     1620    0.008    0.000   10.689    0.007 queue.py:153(get)
      526    0.003    0.000   10.671    0.020 threading.py:270(wait)
     5884   10.669    0.002   10.669    0.002 {method 'acquire' of '_thread.lock' objects}
     1800    0.003    0.000    0.063    0.000 profiler.py:426(__init__)
     1800    0.061    0.000    0.061    0.000 {built-in method zeros}
     1620    0.002    0.000    0.054    0.000 dataloader.py:1225(_process_data)
     1620    0.005    0.000    0.052    0.000 dataloader.py:1205(_try_put_index)
     1800    0.006    0.000    0.038    0.000 profiler.py:434(__enter__)
     1620    0.001    0.000    0.038    0.000 dataloader.py:511(_next_index)
      720    0.018    0.000    0.036    0.000 sampler.py:227(__iter__)
     1800    0.033    0.000    0.033    0.000 {built-in method torch._ops.profiler._record_function_enter}
     1800    0.003    0.000    0.025    0.000 profiler.py:438(__exit__)
     1800    0.022    0.000    0.022    0.000 {built-in method torch._ops.profiler._record_function_exit}
    56340    0.010    0.000    0.010    0.000 sampler.py:112(__iter__)
      540    0.003    0.000    0.009    0.000 queues.py:80(put)
     2160    0.004    0.000    0.009    0.000 threading.py:341(notify)
3600/1800    0.002    0.000    0.007    0.000 contextlib.py:117(__exit__)
     1800    0.001    0.000    0.005    0.000 fetching.py:287(apply_profiler)
     1620    0.003    0.000    0.005    0.000 threading.py:1071(is_alive)
    56160    0.005    0.000    0.005    0.000 {method 'append' of 'list' objects}
     3420    0.001    0.000    0.004    0.000 {built-in method builtins.isinstance}
     1800    0.001    0.000    0.004    0.000 base.py:68(profile)
    63238    0.004    0.000    0.004    0.000 {built-in method builtins.len}
     1800    0.001    0.000    0.003    0.000 abc.py:96(__instancecheck__)
     1800    0.002    0.000    0.003    0.000 advanced.py:66(stop)
     1066    0.003    0.000    0.003    0.000 {method 'release' of '_thread.lock' objects}
     1620    0.001    0.000    0.002    0.000 threading.py:1017(_wait_for_tstate_lock)
     1800    0.002    0.000    0.002    0.000 {built-in method _abc._abc_instancecheck}
     2686    0.001    0.000    0.002    0.000 threading.py:261(_is_owned)
     2160    0.001    0.000    0.002    0.000 threading.py:246(__enter__)
     2146    0.001    0.000    0.002    0.000 queue.py:208(_qsize)
     2160    0.001    0.000    0.001    0.000 threading.py:249(__exit__)
     1620    0.001    0.000    0.001    0.000 queue.py:216(_get)
      526    0.001    0.000    0.001    0.000 threading.py:258(_acquire_restore)
     1800    0.001    0.000    0.001    0.000 supporters.py:519(loader_iters)
  360/180    0.000    0.000    0.001    0.000 {method 'throw' of 'generator' objects}
     2160    0.001    0.000    0.001    0.000 {method '__enter__' of '_thread.lock' objects}
     1800    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
      540    0.001    0.000    0.001    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
     2160    0.000    0.000    0.000    0.000 {method '__exit__' of '_thread.lock' objects}
     2146    0.000    0.000    0.000    0.000 {built-in method time.monotonic}
     1620    0.000    0.000    0.000    0.000 threading.py:513(is_set)
      526    0.000    0.000    0.000    0.000 threading.py:255(_release_save)
     1620    0.000    0.000    0.000    0.000 {method 'popleft' of 'collections.deque' objects}
     1800    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
     1066    0.000    0.000    0.000    0.000 {method 'append' of 'collections.deque' objects}
      756    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
      526    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
      540    0.000    0.000    0.000    0.000 {method 'remove' of 'collections.deque' objects}
        1    0.000    0.000    0.000    0.000 abc.py:100(__subclasscheck__)
        1    0.000    0.000    0.000    0.000 {built-in method _abc._abc_subclasscheck}
        1    0.000    0.000    0.000    0.000 _collections_abc.py:271(__subclasshook__)
        1    0.000    0.000    0.000    0.000 _collections_abc.py:72(_check_methods)



Profile stats for: training_batch_to_device
         213852 function calls (208992 primitive calls) in 0.279 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1620    0.005    0.000    0.274    0.000 accelerator.py:192(batch_to_device)
     1620    0.006    0.000    0.258    0.000 lightning.py:282(_apply_batch_transfer_handler)
     1620    0.002    0.000    0.169    0.000 hooks.py:652(transfer_batch_to_device)
     1620    0.003    0.000    0.167    0.000 apply_func.py:230(move_data_to_device)
4860/1620    0.013    0.000    0.164    0.000 apply_func.py:66(apply_to_collection)
     3240    0.006    0.000    0.142    0.000 apply_func.py:247(batch_to)
     3240    0.136    0.000    0.136    0.000 {method 'to' of 'torch._C._TensorBase' objects}
     1620    0.004    0.000    0.082    0.000 signature_utils.py:18(is_param_in_hook_signature)
     1620    0.001    0.000    0.078    0.000 inspect.py:3103(signature)
     1620    0.002    0.000    0.076    0.000 inspect.py:2851(from_callable)
3240/1620    0.010    0.000    0.074    0.000 inspect.py:2218(_signature_from_callable)
     1620    0.017    0.000    0.042    0.000 inspect.py:2124(_signature_from_function)
     3240    0.012    0.000    0.016    0.000 inspect.py:2772(__init__)
     1620    0.005    0.000    0.015    0.000 inspect.py:1812(_signature_bound_method)
     6480    0.009    0.000    0.015    0.000 inspect.py:2489(__init__)
    34020    0.006    0.000    0.014    0.000 {built-in method builtins.isinstance}
     1620    0.002    0.000    0.009    0.000 inspect.py:2865(replace)
    11340    0.002    0.000    0.008    0.000 abc.py:96(__instancecheck__)
     1620    0.001    0.000    0.007    0.000 accelerator.py:172(lightning_module)
    11340    0.006    0.000    0.006    0.000 {built-in method _abc._abc_instancecheck}
     1620    0.001    0.000    0.005    0.000 training_type_plugin.py:171(lightning_module)
     6480    0.003    0.000    0.005    0.000 enum.py:313(__call__)
     1620    0.001    0.000    0.004    0.000 base.py:104(unwrap_lightning_module)
     1620    0.003    0.000    0.004    0.000 inspect.py:493(unwrap)
     1620    0.001    0.000    0.004    0.000 contextlib.py:117(__exit__)
     1620    0.000    0.000    0.003    0.000 {built-in method builtins.next}
     8100    0.002    0.000    0.003    0.000 inspect.py:2821(<genexpr>)
     1620    0.001    0.000    0.003    0.000 base.py:68(profile)
     1620    0.001    0.000    0.002    0.000 advanced.py:66(stop)
     1620    0.001    0.000    0.002    0.000 accelerator.py:180(root_device)
     3240    0.001    0.000    0.002    0.000 inspect.py:158(isfunction)
     9720    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
     6480    0.001    0.000    0.001    0.000 enum.py:631(__new__)
    11340    0.001    0.000    0.001    0.000 inspect.py:2539(name)
     9720    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
     6480    0.001    0.000    0.001    0.000 {method 'isidentifier' of 'str' objects}
     1620    0.001    0.000    0.001    0.000 inspect.py:513(_is_wrapper)
     8100    0.001    0.000    0.001    0.000 inspect.py:2551(kind)
     1620    0.001    0.000    0.001    0.000 {method 'values' of 'mappingproxy' objects}
     1620    0.000    0.000    0.001    0.000 apply_func.py:56(_is_namedtuple)
     1620    0.001    0.000    0.001    0.000 trainer.py:1593(accelerator)
     1620    0.001    0.000    0.001    0.000 single_device.py:63(root_device)
     4860    0.000    0.000    0.000    0.000 inspect.py:2543(default)
     3242    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
     1620    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
     3240    0.000    0.000    0.000    0.000 inspect.py:2857(parameters)
     1622    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
     1620    0.000    0.000    0.000    0.000 base.py:54(trainer)
     1620    0.000    0.000    0.000    0.000 {built-in method builtins.id}
     1620    0.000    0.000    0.000    0.000 hooks.py:709(on_before_batch_transfer)
     1620    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
     1620    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
     1620    0.000    0.000    0.000    0.000 hooks.py:744(on_after_batch_transfer)
        3    0.000    0.000    0.000    0.000 abc.py:100(__subclasscheck__)
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_subclasscheck}
        2    0.000    0.000    0.000    0.000 apply_func.py:222(__subclasshook__)



Profile stats for: on_batch_start
         74520 function calls in 0.031 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1620    0.005    0.000    0.018    0.000 callback_hook.py:155(on_batch_start)
     4860    0.002    0.000    0.012    0.000 trainer.py:1668(lightning_module)
     4860    0.002    0.000    0.009    0.000 accelerator.py:172(lightning_module)
     4860    0.001    0.000    0.008    0.000 training_type_plugin.py:171(lightning_module)
     3240    0.003    0.000    0.008    0.000 {built-in method builtins.getattr}
     4860    0.002    0.000    0.006    0.000 base.py:104(unwrap_lightning_module)
     1620    0.003    0.000    0.005    0.000 module.py:1164(__getattr__)
     9720    0.002    0.000    0.004    0.000 {built-in method builtins.isinstance}
     1620    0.001    0.000    0.003    0.000 contextlib.py:117(__exit__)
     1620    0.000    0.000    0.002    0.000 {built-in method builtins.next}
     1620    0.001    0.000    0.002    0.000 base.py:68(profile)
     4860    0.001    0.000    0.002    0.000 abc.py:96(__instancecheck__)
     1620    0.002    0.000    0.002    0.000 {method 'format' of 'str' objects}
     1620    0.001    0.000    0.002    0.000 advanced.py:66(stop)
     6480    0.001    0.000    0.001    0.000 trainer.py:1593(accelerator)
     4860    0.001    0.000    0.001    0.000 {built-in method _abc._abc_instancecheck}
     1620    0.001    0.000    0.001    0.000 trainer.py:1597(training_type_plugin)
     4860    0.001    0.000    0.001    0.000 base.py:168(on_batch_start)
     3240    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
     1620    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
     1620    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
     1620    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_batch_start
         579960 function calls (575100 primitive calls) in 0.251 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1620    0.009    0.000    0.244    0.000 callback_hook.py:166(on_train_batch_start)
     4860    0.010    0.000    0.218    0.000 signature_utils.py:18(is_param_in_hook_signature)
     4860    0.003    0.000    0.207    0.000 inspect.py:3103(signature)
     4860    0.004    0.000    0.204    0.000 inspect.py:2851(from_callable)
9720/4860    0.022    0.000    0.201    0.000 inspect.py:2218(_signature_from_callable)
     4860    0.043    0.000    0.121    0.000 inspect.py:2124(_signature_from_function)
     9720    0.035    0.000    0.051    0.000 inspect.py:2772(__init__)
    29160    0.026    0.000    0.046    0.000 inspect.py:2489(__init__)
     4860    0.011    0.000    0.045    0.000 inspect.py:1812(_signature_bound_method)
     4860    0.004    0.000    0.031    0.000 inspect.py:2865(replace)
     4860    0.003    0.000    0.016    0.000 trainer.py:1668(lightning_module)
    29160    0.010    0.000    0.014    0.000 enum.py:313(__call__)
     4860    0.002    0.000    0.012    0.000 accelerator.py:172(lightning_module)
    68040    0.008    0.000    0.010    0.000 {built-in method builtins.isinstance}
     4860    0.002    0.000    0.010    0.000 training_type_plugin.py:171(lightning_module)
    34020    0.008    0.000    0.010    0.000 inspect.py:2821(<genexpr>)
     4860    0.006    0.000    0.009    0.000 inspect.py:493(unwrap)
     4860    0.003    0.000    0.008    0.000 base.py:104(unwrap_lightning_module)
    53460    0.005    0.000    0.005    0.000 inspect.py:2539(name)
    29160    0.004    0.000    0.004    0.000 enum.py:631(__new__)
    35640    0.004    0.000    0.004    0.000 {method 'get' of 'dict' objects}
     1620    0.001    0.000    0.003    0.000 contextlib.py:117(__exit__)
    29160    0.003    0.000    0.003    0.000 {method 'isidentifier' of 'str' objects}
    29160    0.003    0.000    0.003    0.000 {method 'append' of 'list' objects}
    34020    0.003    0.000    0.003    0.000 inspect.py:2551(kind)
     4860    0.001    0.000    0.003    0.000 abc.py:96(__instancecheck__)
     9720    0.002    0.000    0.003    0.000 inspect.py:158(isfunction)
     1620    0.000    0.000    0.002    0.000 {built-in method builtins.next}
     4860    0.001    0.000    0.002    0.000 inspect.py:513(_is_wrapper)
     1620    0.001    0.000    0.002    0.000 base.py:68(profile)
    24300    0.002    0.000    0.002    0.000 inspect.py:2543(default)
     9720    0.002    0.000    0.002    0.000 {built-in method builtins.getattr}
     8100    0.002    0.000    0.002    0.000 trainer.py:1593(accelerator)
     4860    0.002    0.000    0.002    0.000 {built-in method _abc._abc_instancecheck}
     1620    0.001    0.000    0.001    0.000 advanced.py:66(stop)
     3240    0.001    0.000    0.001    0.000 trainer.py:1597(training_type_plugin)
    12960    0.001    0.000    0.001    0.000 {built-in method builtins.callable}
     6480    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
     4860    0.001    0.000    0.001    0.000 {method 'values' of 'mappingproxy' objects}
     9720    0.001    0.000    0.001    0.000 inspect.py:2857(parameters)
     4860    0.001    0.000    0.001    0.000 base.py:99(on_train_batch_start)
     4860    0.001    0.000    0.001    0.000 {built-in method builtins.id}
     4860    0.001    0.000    0.001    0.000 {built-in method sys.getrecursionlimit}
     4860    0.001    0.000    0.001    0.000 {built-in method builtins.len}
     1620    0.000    0.000    0.000    0.000 hooks.py:82(on_train_batch_start)
     1620    0.000    0.000    0.000    0.000 training_type_plugin.py:363(on_train_batch_start)
     1620    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: run_training_batch
         354794 function calls (343454 primitive calls) in 42.480 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
3240/1620    0.011    0.000   42.480    0.026 base.py:109(run)
     1620    0.011    0.000   42.454    0.026 training_batch_loop.py:72(advance)
     1620    0.002    0.000   42.299    0.026 optimizer_loop.py:214(advance)
     1620    0.006    0.000   42.297    0.026 optimizer_loop.py:231(_run_optimization)
     1620    0.014    0.000   42.254    0.026 optimizer_loop.py:353(_optimizer_step)
     1620    0.001    0.000   42.213    0.026 lightning.py:1581(optimizer_step)
     1620    0.005    0.000   42.212    0.026 optimizer.py:95(step)
     1620    0.001    0.000   42.203    0.026 contextlib.py:108(__enter__)
     1620    0.001    0.000   42.202    0.026 {built-in method builtins.next}
     1620    0.001    0.000   42.202    0.026 base.py:68(profile)
     1620    0.002    0.000   42.201    0.026 advanced.py:61(start)
     1620   42.199    0.026   42.199    0.026 {method 'enable' of '_lsprof.Profiler' objects}
     1620    0.001    0.000    0.117    0.000 logger_connector.py:211(on_train_split_start)
     1620    0.004    0.000    0.115    0.000 logger_connector.py:256(on_new_batch)
     1620    0.002    0.000    0.086    0.000 result.py:558(extract_batch_size)
     1620    0.004    0.000    0.061    0.000 result.py:378(batch_size)
     1620    0.057    0.000    0.057    0.000 {built-in method tensor}
     3240    0.002    0.000    0.026    0.000 trainer.py:2139(_results)
     1620    0.009    0.000    0.025    0.000 optimizer_loop.py:283(_make_closure)
     1620    0.002    0.000    0.022    0.000 data.py:45(extract_batch_size)
     8100    0.010    0.000    0.020    0.000 enums.py:30(__eq__)
11340/4860    0.007    0.000    0.020    0.000 data.py:30(_extract_batch_size)
40501/37261    0.009    0.000    0.019    0.000 {built-in method builtins.isinstance}
     6480    0.004    0.000    0.019    0.000 trainer.py:1945(training)
     4860    0.003    0.000    0.018    0.000 trainer.py:1668(lightning_module)
     1620    0.005    0.000    0.015    0.000 training_batch_loop.py:62(on_run_start)
     4860    0.002    0.000    0.014    0.000 accelerator.py:172(lightning_module)
     3240    0.002    0.000    0.014    0.000 trainer.py:2114(_active_loop)
     4860    0.002    0.000    0.012    0.000 training_type_plugin.py:171(lightning_module)
     1620    0.003    0.000    0.010    0.000 training_batch_loop.py:108(_tbptt_split_batch)
     3240    0.002    0.000    0.010    0.000 fit_loop.py:142(_results)
     4860    0.003    0.000    0.010    0.000 base.py:104(unwrap_lightning_module)
     1620    0.001    0.000    0.008    0.000 fit_loop.py:265(_should_accumulate)
     3240    0.002    0.000    0.007    0.000 typing.py:768(__instancecheck__)
    16200    0.005    0.000    0.007    0.000 types.py:171(__get__)
     1620    0.003    0.000    0.007    0.000 optimizer.py:63(_to_lightning_optimizer)
     1620    0.003    0.000    0.006    0.000 training_epoch_loop.py:360(_should_accumulate)
     3240    0.002    0.000    0.006    0.000 typing.py:771(__subclasscheck__)
     3240    0.002    0.000    0.005    0.000 trainer.py:1701(amp_backend)
     1620    0.004    0.000    0.005    0.000 optimizer_loop.py:206(on_run_start)
     1620    0.004    0.000    0.005    0.000 typing.py:868(__new__)
     1620    0.003    0.000    0.005    0.000 optimizer_loop.py:127(__init__)
    32400    0.005    0.000    0.005    0.000 base.py:54(trainer)
     4860    0.001    0.000    0.003    0.000 abc.py:96(__instancecheck__)
     1620    0.001    0.000    0.003    0.000 contextlib.py:238(helper)
     3240    0.001    0.000    0.003    0.000 {built-in method builtins.issubclass}
     3240    0.003    0.000    0.003    0.000 {method 'size' of 'torch._C._TensorBase' objects}
     3240    0.002    0.000    0.003    0.000 accelerator.py:369(amp_backend)
     1620    0.001    0.000    0.003    0.000 optimizer_loop.py:335(_run_optimization_start)
    16202    0.003    0.000    0.003    0.000 trainer.py:1593(accelerator)
     1620    0.001    0.000    0.002    0.000 trainer.py:2023(current_epoch)
     1620    0.002    0.000    0.002    0.000 contextlib.py:82(__init__)
     3240    0.002    0.000    0.002    0.000 base.py:174(on_advance_start)
    16200    0.002    0.000    0.002    0.000 enum.py:753(value)
     1620    0.002    0.000    0.002    0.000 optimizer_loop.py:198(reset)
     1620    0.002    0.000    0.002    0.000 utilities.py:151(_get_active_optimizers)
     4860    0.002    0.000    0.002    0.000 {built-in method _abc._abc_instancecheck}
     1620    0.002    0.000    0.002    0.000 optimizer_loop.py:298(_make_zero_grad_fn)
     3240    0.001    0.000    0.002    0.000 optimizer_loop.py:190(done)
     3240    0.001    0.000    0.002    0.000 abc.py:100(__subclasscheck__)
     1620    0.002    0.000    0.002    0.000 closure.py:60(__init__)
     1620    0.002    0.000    0.002    0.000 optimizer_loop.py:294(_make_step_fn)
     1620    0.002    0.000    0.002    0.000 optimizer_loop.py:317(_make_backward_fn)
    16200    0.002    0.000    0.002    0.000 {method 'lower' of 'str' objects}
     1620    0.002    0.000    0.002    0.000 progress.py:126(increment_ready)
     1620    0.001    0.000    0.002    0.000 training_epoch_loop.py:347(_num_ready_batches_reached)
     3242    0.001    0.000    0.002    0.000 trainer.py:1672(optimizers)
     1620    0.001    0.000    0.001    0.000 training_epoch_loop.py:343(_accumulated_batches_reached)
     3240    0.001    0.000    0.001    0.000 trainer.py:1597(training_type_plugin)
     1620    0.001    0.000    0.001    0.000 training_batch_loop.py:45(done)
     1620    0.001    0.000    0.001    0.000 training_batch_loop.py:58(reset)
     3240    0.001    0.000    0.001    0.000 {built-in method _abc._abc_subclasscheck}
     1620    0.001    0.000    0.001    0.000 trainer.py:1778(lightning_optimizers)
     6480    0.001    0.000    0.001    0.000 utils.py:51(void)
     6480    0.001    0.000    0.001    0.000 {built-in method builtins.len}
     6480    0.001    0.000    0.001    0.000 trainer.py:2047(fit_loop)
     1620    0.001    0.000    0.001    0.000 fit_loop.py:55(current_epoch)
     1620    0.001    0.000    0.001    0.000 {built-in method __new__ of type object at 0x908780}
     1620    0.001    0.000    0.001    0.000 trainer.py:1693(optimizer_frequencies)
     1620    0.001    0.000    0.001    0.000 lightning.py:263(truncated_bptt_steps)
     1620    0.001    0.000    0.001    0.000 {method 'pop' of 'list' objects}
     3240    0.001    0.000    0.001    0.000 base.py:84(skip)
     3240    0.001    0.000    0.001    0.000 training_type_plugin.py:276(handles_gradient_accumulation)
     1620    0.000    0.000    0.000    0.000 lightning.py:254(automatic_optimization)
     1620    0.000    0.000    0.000    0.000 trainer.py:1632(_device_type)
     1620    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
     1620    0.000    0.000    0.000    0.000 optimizer_loop.py:186(optimizer_idx)
     1620    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 optimizers.py:112(convert_to_lightning_optimizers)
        1    0.000    0.000    0.000    0.000 optimizers.py:119(<dictcomp>)
        1    0.000    0.000    0.000    0.000 optimizers.py:113(_convert_to_lightning_optimizer)
        1    0.000    0.000    0.000    0.000 optimizer.py:33(__init__)
        1    0.000    0.000    0.000    0.000 optimizer.py:36(<dictcomp>)
        1    0.000    0.000    0.000    0.000 optimizer.py:56(_on_trainer_init)
        1    0.000    0.000    0.000    0.000 {built-in method _weakref.proxy}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}



Profile stats for: optimizer_step_with_closure_0
         64800 function calls in 15.674 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1620    0.002    0.000   15.674    0.010 accelerator.py:318(optimizer_step)
     1620    0.005    0.000   15.668    0.010 precision_plugin.py:152(optimizer_step)
     1620    0.008    0.000   15.662    0.010 optimizer.py:83(wrapper)
     1620    0.004    0.000   15.618    0.010 grad_mode.py:25(decorate_context)
     1620    0.003    0.000   15.604    0.010 adam.py:81(step)
     1620    0.001    0.000   15.600    0.010 precision_plugin.py:135(_wrap_closure)
     1620    0.001    0.000   15.599    0.010 optimizer_loop.py:159(__call__)
     1620    0.002    0.000   15.598    0.010 optimizer_loop.py:140(closure)
     1620    0.001    0.000   15.593    0.010 contextlib.py:108(__enter__)
     1620    0.000    0.000   15.592    0.010 {built-in method builtins.next}
     1620    0.001    0.000   15.592    0.010 base.py:68(profile)
     1620    0.001    0.000   15.591    0.010 advanced.py:61(start)
     1620   15.590    0.010   15.590    0.010 {method 'enable' of '_lsprof.Profiler' objects}
     1620    0.004    0.000    0.019    0.000 profiler.py:434(__enter__)
     1620    0.003    0.000    0.016    0.000 profiler.py:426(__init__)
     1620    0.015    0.000    0.015    0.000 {built-in method torch._ops.profiler._record_function_enter}
     1620    0.014    0.000    0.014    0.000 {built-in method zeros}
     1620    0.002    0.000    0.005    0.000 grad_mode.py:124(__enter__)
     1620    0.001    0.000    0.004    0.000 accelerator.py:172(lightning_module)
     1620    0.004    0.000    0.004    0.000 grad_mode.py:119(__init__)
     1620    0.001    0.000    0.004    0.000 training_type_plugin.py:171(lightning_module)
     1620    0.001    0.000    0.003    0.000 contextlib.py:238(helper)
     1620    0.001    0.000    0.003    0.000 base.py:104(unwrap_lightning_module)
     1620    0.002    0.000    0.002    0.000 grad_mode.py:213(__init__)
     4860    0.001    0.000    0.002    0.000 {built-in method builtins.isinstance}
     1620    0.002    0.000    0.002    0.000 contextlib.py:82(__init__)
     1620    0.001    0.000    0.002    0.000 grad_mode.py:167(__enter__)
     1620    0.001    0.000    0.001    0.000 {method 'format' of 'str' objects}
     4860    0.001    0.000    0.001    0.000 {built-in method torch._C.is_grad_enabled}
     1620    0.000    0.000    0.001    0.000 abc.py:96(__instancecheck__)
     3240    0.001    0.000    0.001    0.000 {built-in method torch._C._set_grad_enabled}
     1620    0.001    0.000    0.001    0.000 {built-in method _abc._abc_instancecheck}
     1620    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
     1620    0.000    0.000    0.000    0.000 _jit_internal.py:957(is_scripting)
     1620    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)



Profile stats for: training_step_and_backward
         32400 function calls in 14.316 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1620    0.003    0.000   14.316    0.009 optimizer_loop.py:412(_training_step)
     1620    0.001    0.000   14.305    0.009 contextlib.py:108(__enter__)
     1620    0.000    0.000   14.305    0.009 {built-in method builtins.next}
     1620    0.001    0.000   14.304    0.009 base.py:68(profile)
     1620    0.001    0.000   14.304    0.009 advanced.py:61(start)
     1620   14.303    0.009   14.303    0.009 {method 'enable' of '_lsprof.Profiler' objects}
     1620    0.001    0.000    0.006    0.000 trainer.py:1668(lightning_module)
     1620    0.001    0.000    0.004    0.000 accelerator.py:172(lightning_module)
     1620    0.001    0.000    0.004    0.000 training_type_plugin.py:171(lightning_module)
     1620    0.001    0.000    0.003    0.000 base.py:104(unwrap_lightning_module)
     3240    0.001    0.000    0.002    0.000 {built-in method builtins.isinstance}
     1620    0.001    0.000    0.002    0.000 contextlib.py:238(helper)
     1620    0.001    0.000    0.001    0.000 contextlib.py:82(__init__)
     1620    0.000    0.000    0.001    0.000 abc.py:96(__instancecheck__)
     1620    0.001    0.000    0.001    0.000 {built-in method _abc._abc_instancecheck}
     3240    0.000    0.000    0.000    0.000 base.py:54(trainer)
     1620    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
     1620    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}



Profile stats for: model_forward
         140940 function calls (139320 primitive calls) in 12.449 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1620    0.001    0.000   12.365    0.008 contextlib.py:108(__enter__)
     1620    0.000    0.000   12.364    0.008 {built-in method builtins.next}
     1620    0.001    0.000   12.363    0.008 base.py:68(profile)
     1620    0.001    0.000   12.363    0.008 advanced.py:61(start)
     1620   12.362    0.008   12.362    0.008 {method 'enable' of '_lsprof.Profiler' objects}
     1620    0.006    0.000    0.075    0.000 utilities.py:65(_build_training_step_kwargs)
     1620    0.004    0.000    0.067    0.000 signature_utils.py:18(is_param_in_hook_signature)
     1620    0.001    0.000    0.063    0.000 inspect.py:3103(signature)
     1620    0.002    0.000    0.062    0.000 inspect.py:2851(from_callable)
3240/1620    0.010    0.000    0.060    0.000 inspect.py:2218(_signature_from_callable)
     1620    0.013    0.000    0.032    0.000 inspect.py:2124(_signature_from_function)
     1620    0.004    0.000    0.013    0.000 inspect.py:1812(_signature_bound_method)
     3240    0.009    0.000    0.012    0.000 inspect.py:2772(__init__)
     4860    0.006    0.000    0.011    0.000 inspect.py:2489(__init__)
     1620    0.001    0.000    0.007    0.000 inspect.py:2865(replace)
     1620    0.004    0.000    0.006    0.000 module.py:1180(__setattr__)
     1620    0.002    0.000    0.004    0.000 inspect.py:493(unwrap)
     4860    0.002    0.000    0.003    0.000 enum.py:313(__call__)
     1620    0.001    0.000    0.003    0.000 contextlib.py:238(helper)
     6480    0.002    0.000    0.002    0.000 inspect.py:2821(<genexpr>)
    16200    0.002    0.000    0.002    0.000 {built-in method builtins.isinstance}
     1620    0.001    0.000    0.002    0.000 contextlib.py:82(__init__)
    11340    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
     4860    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
     3240    0.001    0.000    0.001    0.000 inspect.py:158(isfunction)
     4860    0.001    0.000    0.001    0.000 enum.py:631(__new__)
     1620    0.001    0.000    0.001    0.000 inspect.py:513(_is_wrapper)
     8100    0.001    0.000    0.001    0.000 inspect.py:2539(name)
     1620    0.001    0.000    0.001    0.000 trainer.py:1672(optimizers)
     4860    0.001    0.000    0.001    0.000 {method 'isidentifier' of 'str' objects}
     3240    0.001    0.000    0.001    0.000 base.py:54(trainer)
     6480    0.001    0.000    0.001    0.000 inspect.py:2551(kind)
     4860    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
     1620    0.001    0.000    0.001    0.000 {method 'values' of 'mappingproxy' objects}
     1620    0.000    0.000    0.000    0.000 lightning.py:263(truncated_bptt_steps)
     3240    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
     3240    0.000    0.000    0.000    0.000 inspect.py:2857(parameters)
     1620    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
     3240    0.000    0.000    0.000    0.000 inspect.py:2543(default)
     1620    0.000    0.000    0.000    0.000 {built-in method builtins.id}
     1620    0.000    0.000    0.000    0.000 {built-in method builtins.len}
     1620    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
     1620    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)



Profile stats for: training_step
         1747196 function calls (1720636 primitive calls) in 12.209 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1620    0.007    0.000   12.205    0.008 accelerator.py:210(training_step)
     1620    0.003    0.000   12.183    0.008 training_type_plugin.py:212(training_step)
     1620    0.014    0.000   12.179    0.008 cnn.py:45(training_step)
17820/3240    0.041    0.000   11.659    0.004 module.py:1096(_call_impl)
     1620    0.024    0.000   10.604    0.007 metric.py:183(forward)
     4860    0.019    0.000    9.758    0.002 metric.py:251(wrapped_func)
     3240    0.112    0.000    9.714    0.003 accuracy.py:218(update)
     6480    0.201    0.000    8.436    0.001 checks.py:190(_check_classification_inputs)
     3240    0.005    0.000    8.180    0.003 accuracy.py:29(_mode)
     6480    8.007    0.001    8.111    0.001 checks.py:29(_basic_input_validation)
     3240    0.017    0.000    1.372    0.000 accuracy.py:64(_accuracy_update)
     3240    0.023    0.000    1.307    0.000 stat_scores.py:76(_stat_scores_update)
     1620    0.057    0.000    1.038    0.001 cnn.py:28(forward)
     3240    0.052    0.000    0.800    0.000 checks.py:296(_input_format_classification)
     1620    0.009    0.000    0.540    0.000 metric.py:352(wrapped_func)
     1620    0.006    0.000    0.495    0.000 accuracy.py:270(compute)
     1620    0.032    0.000    0.486    0.000 accuracy.py:115(_accuracy_compute)
     3240    0.245    0.000    0.484    0.000 stat_scores.py:28(_stat_scores)
     1620    0.134    0.000    0.437    0.000 stat_scores.py:183(_reduce_stat_scores)
     1620    0.035    0.000    0.436    0.000 lightning.py:322(log)
     4860    0.009    0.000    0.433    0.000 conv.py:445(forward)
     4860    0.008    0.000    0.420    0.000 conv.py:437(_conv_forward)
     4860    0.412    0.000    0.412    0.000 {built-in method conv2d}
    14580    0.255    0.000    0.255    0.000 {method 'sum' of 'torch._C._TensorBase' objects}
     3240    0.016    0.000    0.243    0.000 data.py:91(select_topk)
     1620    0.017    0.000    0.234    0.000 result.py:382(log)
     1620    0.027    0.000    0.216    0.000 metric.py:387(reset)
     4860    0.008    0.000    0.210    0.000 linear.py:102(forward)
    72901    0.060    0.000    0.206    0.000 metric.py:421(__setattr__)
     4860    0.006    0.000    0.198    0.000 functional.py:1832(linear)
     4860    0.191    0.000    0.191    0.000 {built-in method torch._C._nn.linear}
     1620    0.004    0.000    0.178    0.000 result.py:461(update_metrics)
     1620    0.003    0.000    0.174    0.000 apply_func.py:142(apply_to_collections)
     1620    0.005    0.000    0.171    0.000 result.py:462(fn)
     1620    0.005    0.000    0.156    0.000 module.py:795(to)
     8100    0.010    0.000    0.149    0.000 functional.py:1288(relu)
     1620    0.027    0.000    0.147    0.000 metric.py:466(_apply)
    72902    0.111    0.000    0.147    0.000 module.py:1180(__setattr__)
     8100    0.137    0.000    0.137    0.000 {built-in method relu}
     6660    0.135    0.000    0.135    0.000 {built-in method tensor}
     3240    0.023    0.000    0.133    0.000 data.py:57(to_onehot)
     4860    0.008    0.000    0.107    0.000 pooling.py:161(forward)
     9720    0.103    0.000    0.103    0.000 {method 'clone' of 'torch._C._TensorBase' objects}
     6480    0.099    0.000    0.099    0.000 {method 'max' of 'torch._C._TensorBase' objects}
     4860    0.007    0.000    0.099    0.000 _jit_internal.py:412(fn)
     6480    0.097    0.000    0.097    0.000 {method 'min' of 'torch._C._TensorBase' objects}
     4860    0.005    0.000    0.091    0.000 functional.py:697(_max_pool2d)
    29170    0.010    0.000    0.090    0.000 {built-in method builtins.setattr}
     3240    0.089    0.000    0.089    0.000 {method 'scatter' of 'torch._C._TensorBase' objects}
     1620    0.006    0.000    0.086    0.000 signature_utils.py:18(is_param_in_hook_signature)
     4860    0.085    0.000    0.085    0.000 {built-in method max_pool2d}
     1621    0.002    0.000    0.080    0.000 inspect.py:3103(signature)
     1621    0.002    0.000    0.078    0.000 inspect.py:2851(from_callable)
3242/1621    0.011    0.000    0.076    0.000 inspect.py:2218(_signature_from_callable)
     9720    0.074    0.000    0.074    0.000 {method 'int' of 'torch._C._TensorBase' objects}
     4860    0.069    0.000    0.069    0.000 {built-in method zeros}
    24300    0.033    0.000    0.069    0.000 enums.py:38(__eq__)
     6480    0.068    0.000    0.068    0.000 {built-in method where}
     1620    0.004    0.000    0.067    0.000 functional.py:2767(cross_entropy)
     1620    0.061    0.000    0.061    0.000 {built-in method torch._C._nn.cross_entropy_loss}
   268477    0.040    0.000    0.055    0.000 {built-in method builtins.isinstance}
    19440    0.052    0.000    0.052    0.000 {method 'squeeze' of 'torch._C._TensorBase' objects}
     3240    0.052    0.000    0.052    0.000 {built-in method zeros_like}
7070/6661    0.011    0.000    0.048    0.000 apply_func.py:66(apply_to_collection)
     3240    0.048    0.000    0.048    0.000 {method 'argmax' of 'torch._C._TensorBase' objects}
     6480    0.008    0.000    0.046    0.000 checks.py:284(_input_squeeze)
     1621    0.017    0.000    0.042    0.000 inspect.py:2124(_signature_from_function)
    22680    0.014    0.000    0.041    0.000 module.py:893(convert)
     3240    0.040    0.000    0.040    0.000 {method 'scatter_' of 'torch._C._TensorBase' objects}
     3240    0.032    0.000    0.032    0.000 {method 'float' of 'torch._C._TensorBase' objects}
11340/8100    0.005    0.000    0.032    0.000 {built-in method builtins.next}
    50220    0.019    0.000    0.027    0.000 types.py:171(__get__)
    32400    0.026    0.000    0.026    0.000 {method 'to' of 'torch._C._TensorBase' objects}
     1620    0.003    0.000    0.025    0.000 trainer.py:2139(_results)
     6480    0.024    0.000    0.025    0.000 checks.py:51(_check_shape_and_type_consistency)
     9720    0.023    0.000    0.023    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
    37260    0.022    0.000    0.022    0.000 module.py:1164(__getattr__)
4860/3240    0.003    0.000    0.021    0.000 contextlib.py:108(__enter__)
6480/4860    0.007    0.000    0.018    0.000 contextlib.py:117(__exit__)
     6480    0.018    0.000    0.018    0.000 {method 'reshape' of 'torch._C._TensorBase' objects}
     1620    0.018    0.000    0.018    0.000 {built-in method ones_like}
   228433    0.018    0.000    0.018    0.000 {method 'get' of 'dict' objects}
    17820    0.018    0.000    0.018    0.000 {built-in method torch._C._get_tracing_state}
     4860    0.006    0.000    0.017    0.000 trainer.py:1945(training)
     1620    0.016    0.000    0.016    0.000 {built-in method isnan}
     3242    0.012    0.000    0.016    0.000 inspect.py:2772(__init__)
     1621    0.006    0.000    0.016    0.000 inspect.py:1812(_signature_bound_method)
     1620    0.016    0.000    0.016    0.000 {method 'view' of 'torch._C._TensorBase' objects}
    45360    0.016    0.000    0.016    0.000 {method 'is_floating_point' of 'torch._C._TensorBase' objects}
     3240    0.015    0.000    0.015    0.000 {method 'unsqueeze' of 'torch._C._TensorBase' objects}
    19952    0.004    0.000    0.015    0.000 abc.py:96(__instancecheck__)
     3240    0.004    0.000    0.014    0.000 metric.py:317(sync_context)
     4863    0.008    0.000    0.014    0.000 inspect.py:2489(__init__)
     1620    0.004    0.000    0.013    0.000 memory.py:41(recursive_detach)
     4860    0.006    0.000    0.012    0.000 enums.py:30(__eq__)
     6519    0.004    0.000    0.012    0.000 apply_func.py:61(_is_dataclass_instance)
     3240    0.012    0.000    0.012    0.000 {method 'expand_as' of 'torch._C._TensorBase' objects}
     1620    0.012    0.000    0.012    0.000 {built-in method flatten}
     1620    0.007    0.000    0.011    0.000 fit_loop.py:142(_results)
     4860    0.003    0.000    0.011    0.000 contextlib.py:238(helper)
     1620    0.002    0.000    0.011    0.000 trainer.py:2114(_active_loop)
    19952    0.007    0.000    0.011    0.000 {built-in method _abc._abc_instancecheck}
     1620    0.002    0.000    0.010    0.000 metric.py:259(sync)
     1620    0.004    0.000    0.010    0.000 module.py:568(_apply)
     3240    0.003    0.000    0.009    0.000 precision_plugin.py:231(train_step_context)
     1621    0.004    0.000    0.009    0.000 <string>:2(__init__)
     1620    0.002    0.000    0.009    0.000 result.py:233(forward)
    16200    0.009    0.000    0.009    0.000 {method 'long' of 'torch._C._TensorBase' objects}
     1621    0.002    0.000    0.008    0.000 inspect.py:2865(replace)
    50220    0.008    0.000    0.008    0.000 enum.py:753(value)
     4860    0.007    0.000    0.008    0.000 contextlib.py:82(__init__)
     1620    0.004    0.000    0.008    0.000 metric.py:34(jit_distributed_available)
     6519    0.003    0.000    0.008    0.000 dataclasses.py:1045(is_dataclass)
    59940    0.007    0.000    0.007    0.000 {method 'lower' of 'str' objects}
     1620    0.003    0.000    0.007    0.000 grad_mode.py:128(__exit__)
    37307    0.006    0.000    0.006    0.000 {built-in method builtins.getattr}
     1621    0.001    0.000    0.006    0.000 result.py:100(__post_init__)
      180    0.001    0.000    0.006    0.000 result.py:540(reset)
     3240    0.004    0.000    0.006    0.000 grad_mode.py:213(__init__)
     1620    0.002    0.000    0.005    0.000 grad_mode.py:124(__enter__)
     1620    0.002    0.000    0.005    0.000 module.py:1597(children)
     1621    0.001    0.000    0.005    0.000 result.py:57(__post_init__)
     1620    0.002    0.000    0.005    0.000 data.py:166(apply_to_collection)
     1620    0.003    0.000    0.005    0.000 metric.py:205(<dictcomp>)
     1621    0.003    0.000    0.005    0.000 inspect.py:493(unwrap)
     9774    0.005    0.000    0.005    0.000 {built-in method builtins.hasattr}
     1620    0.004    0.000    0.005    0.000 grad_mode.py:119(__init__)
     1619    0.003    0.000    0.005    0.000 <string>:2(__eq__)
     1621    0.003    0.000    0.004    0.000 result.py:105(_parse_reduce_fx)
     8135    0.004    0.000    0.004    0.000 result.py:261(__setattr__)
     4863    0.003    0.000    0.004    0.000 enum.py:313(__call__)
     1621    0.004    0.000    0.004    0.000 result.py:70(_generate_sync_fn)
     1620    0.002    0.000    0.004    0.000 base.py:68(profile)
     3240    0.002    0.000    0.004    0.000 trainer.py:1597(training_type_plugin)
  1772/46    0.000    0.000    0.004    0.000 abc.py:100(__subclasscheck__)
  1772/46    0.003    0.000    0.004    0.000 {built-in method _abc._abc_subclasscheck}
    19440    0.004    0.000    0.004    0.000 {method 'is_complex' of 'torch._C._TensorBase' objects}
     1620    0.003    0.000    0.003    0.000 {built-in method torch._C._nn._parse_to}
     1620    0.003    0.000    0.003    0.000 module.py:1606(named_children)
     6484    0.002    0.000    0.003    0.000 inspect.py:2821(<genexpr>)
     1620    0.001    0.000    0.003    0.000 result.py:194(update)
     3240    0.003    0.000    0.003    0.000 {built-in method builtins.max}
     6519    0.002    0.000    0.003    0.000 apply_func.py:56(_is_namedtuple)
     1620    0.002    0.000    0.003    0.000 stat_scores.py:227(_get_final_stats)
        1    0.000    0.000    0.003    0.003 result.py:446(register_key)
        1    0.000    0.000    0.003    0.003 result.py:452(fn)
    12974    0.002    0.000    0.002    0.000 {built-in method torch._C._has_torch_function_unary}
     1620    0.002    0.000    0.002    0.000 logger_connector.py:294(should_reset_tensors)
     1620    0.002    0.000    0.002    0.000 fx_validator.py:99(check_logging)
     1620    0.002    0.000    0.002    0.000 advanced.py:66(stop)
      180    0.001    0.000    0.002    0.000 result.py:356(__init__)
        1    0.000    0.000    0.002    0.002 result.py:294(to)
     1620    0.002    0.000    0.002    0.000 {method 'size' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.002    0.002 lightning.py:452(<dictcomp>)
     1620    0.001    0.000    0.002    0.000 __init__.py:8(is_available)
     4860    0.002    0.000    0.002    0.000 trainer.py:1593(accelerator)
     4860    0.002    0.000    0.002    0.000 {built-in method torch._C.is_grad_enabled}
     4860    0.002    0.000    0.002    0.000 base.py:54(trainer)
     1620    0.002    0.000    0.002    0.000 lightning.py:594(__auto_choose_log_on_step)
     1620    0.002    0.000    0.002    0.000 result.py:126(sync)
     6480    0.002    0.000    0.002    0.000 {built-in method torch._C._has_torch_function_variadic}
     3242    0.001    0.000    0.001    0.000 inspect.py:158(isfunction)
     1620    0.001    0.000    0.001    0.000 distributed_c10d.py:386(is_initialized)
     1620    0.001    0.000    0.001    0.000 _reduction.py:7(get_enum)
     4863    0.001    0.000    0.001    0.000 enum.py:631(__new__)
     1620    0.001    0.000    0.001    0.000 lightning.py:600(__auto_choose_log_on_epoch)
     8105    0.001    0.000    0.001    0.000 inspect.py:2539(name)
     4863    0.001    0.000    0.001    0.000 {method 'isidentifier' of 'str' objects}
     4860    0.001    0.000    0.001    0.000 {built-in method builtins.len}
     1621    0.001    0.000    0.001    0.000 {method 'values' of 'mappingproxy' objects}
     3240    0.001    0.000    0.001    0.000 {built-in method torch._C._set_grad_enabled}
     5044    0.001    0.000    0.001    0.000 {method 'items' of 'dict' objects}
     4862    0.001    0.000    0.001    0.000 {built-in method builtins.callable}
     1621    0.001    0.000    0.001    0.000 inspect.py:513(_is_wrapper)
     3261    0.001    0.000    0.001    0.000 {built-in method builtins.id}
     6484    0.001    0.000    0.001    0.000 inspect.py:2551(kind)
     5269    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
     3240    0.001    0.000    0.001    0.000 precision_plugin.py:226(forward_context)
     1620    0.001    0.000    0.001    0.000 metric.py:426(device)
      358    0.001    0.000    0.001    0.000 result.py:550(fn)
     1620    0.001    0.000    0.001    0.000 result.py:373(batch_size)
     4878    0.001    0.000    0.001    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 result.py:184(__init__)
        1    0.000    0.000    0.000    0.000 metric.py:75(__init__)
     1621    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
     1620    0.000    0.000    0.000    0.000 training_type_plugin.py:162(model)
     1620    0.000    0.000    0.000    0.000 metric.py:295(unsync)
     1620    0.000    0.000    0.000    0.000 trainer.py:2047(fit_loop)
     3241    0.000    0.000    0.000    0.000 inspect.py:2857(parameters)
     1620    0.000    0.000    0.000    0.000 _jit_internal.py:957(is_scripting)
     1620    0.000    0.000    0.000    0.000 training_type_plugin.py:215(post_training_step)
     3242    0.000    0.000    0.000    0.000 inspect.py:2543(default)
     1620    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
     1621    0.000    0.000    0.000    0.000 result.py:60(should)
        1    0.000    0.000    0.000    0.000 imports.py:42(_compare_version)
     1620    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
        2    0.000    0.000    0.000    0.000 version.py:261(__init__)
    29/11    0.000    0.000    0.000    0.000 module.py:1653(named_modules)
        1    0.000    0.000    0.000    0.000 __init__.py:109(import_module)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:1002(_gcd_import)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:986(_find_and_load)
        1    0.000    0.000    0.000    0.000 metric.py:250(_wrap_update)
        4    0.000    0.000    0.000    0.000 metric.py:560(__hash__)
        1    0.000    0.000    0.000    0.000 device_dtype_mixin.py:24(__init__)
        2    0.000    0.000    0.000    0.000 dataclasses.py:1022(fields)
      418    0.000    0.000    0.000    0.000 _collections_abc.py:392(__subclasshook__)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:147(__enter__)
        2    0.000    0.000    0.000    0.000 version.py:444(_cmpkey)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:157(_get_module_lock)
        1    0.000    0.000    0.000    0.000 module.py:250(__init__)
        2    0.000    0.000    0.000    0.000 typing.py:255(inner)
       18    0.000    0.000    0.000    0.000 dataclasses.py:1037(<genexpr>)
        8    0.000    0.000    0.000    0.000 {built-in method builtins.hash}
        2    0.000    0.000    0.000    0.000 functools.py:34(update_wrapper)
        1    0.000    0.000    0.000    0.000 imports.py:24(_module_available)
        2    0.000    0.000    0.000    0.000 {method 'search' of 're.Pattern' objects}
       10    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
      103    0.000    0.000    0.000    0.000 _collections_abc.py:302(__subclasshook__)
        1    0.000    0.000    0.000    0.000 result.py:241(_wrap_compute)
        1    0.000    0.000    0.000    0.000 {built-in method _operator.ge}
       14    0.000    0.000    0.000    0.000 _tensor.py:650(__hash__)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:58(__init__)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:78(acquire)
        1    0.000    0.000    0.000    0.000 util.py:73(find_spec)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:194(_lock_unlock_module)
        2    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        2    0.000    0.000    0.000    0.000 <string>:1(__new__)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:151(__exit__)
       20    0.000    0.000    0.000    0.000 {method 'group' of 're.Match' objects}
        8    0.000    0.000    0.000    0.000 version.py:271(<genexpr>)
        1    0.000    0.000    0.000    0.000 result.py:157(is_custom_reduction)
        3    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:103(release)
        1    0.000    0.000    0.000    0.000 version.py:87(__ge__)
        2    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:176(cb)
        4    0.000    0.000    0.000    0.000 typing.py:329(__hash__)
        1    0.000    0.000    0.000    0.000 result.py:141(is_mean_reduction)
        2    0.000    0.000    0.000    0.000 functools.py:64(wraps)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:937(_sanity_check)
        1    0.000    0.000    0.000    0.000 {built-in method torch._C.get_default_dtype}
        4    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
        4    0.000    0.000    0.000    0.000 {built-in method _imp.acquire_lock}
        6    0.000    0.000    0.000    0.000 version.py:393(_parse_letter_version)
        2    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x908780}
        2    0.000    0.000    0.000    0.000 {method 'startswith' of 'str' objects}
        4    0.000    0.000    0.000    0.000 {built-in method _imp.release_lock}
        4    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:143(__init__)
        3    0.000    0.000    0.000    0.000 version.py:459(<lambda>)
        2    0.000    0.000    0.000    0.000 {method 'values' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 version.py:432(_parse_local_version)



Profile stats for: training_step_end
         29160 function calls in 0.007 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1620    0.000    0.000    0.002    0.000 contextlib.py:117(__exit__)
     1620    0.000    0.000    0.002    0.000 {built-in method builtins.next}
     1620    0.000    0.000    0.002    0.000 base.py:68(profile)
     3240    0.001    0.000    0.001    0.000 trainer.py:1597(training_type_plugin)
     1620    0.001    0.000    0.001    0.000 advanced.py:66(stop)
     4860    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
     1620    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
     3240    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
     3240    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
     1620    0.000    0.000    0.000    0.000 lightning.py:706(training_step_end)
     1620    0.000    0.000    0.000    0.000 training_type_plugin.py:227(training_step_end)
     1620    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
     1620    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: zero_grad
         45360 function calls in 0.236 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1620    0.001    0.000    0.236    0.000 optimizer_loop.py:311(zero_grad_fn)
     1620    0.004    0.000    0.234    0.000 optimizer_loop.py:391(_on_before_zero_grad)
     1620    0.003    0.000    0.228    0.000 trainer.py:1463(call_hook)
     1620    0.001    0.000    0.211    0.000 contextlib.py:108(__enter__)
     1620    0.000    0.000    0.210    0.000 {built-in method builtins.next}
     1620    0.001    0.000    0.209    0.000 base.py:68(profile)
     1620    0.001    0.000    0.209    0.000 advanced.py:61(start)
     1620    0.208    0.000    0.208    0.000 {method 'enable' of '_lsprof.Profiler' objects}
     1620    0.001    0.000    0.007    0.000 trainer.py:1668(lightning_module)
     1620    0.001    0.000    0.006    0.000 accelerator.py:172(lightning_module)
     1620    0.001    0.000    0.005    0.000 training_type_plugin.py:171(lightning_module)
     1620    0.004    0.000    0.005    0.000 module.py:1180(__setattr__)
     1620    0.001    0.000    0.004    0.000 base.py:104(unwrap_lightning_module)
     6480    0.002    0.000    0.003    0.000 {built-in method builtins.isinstance}
     1620    0.001    0.000    0.003    0.000 contextlib.py:238(helper)
     1620    0.002    0.000    0.002    0.000 contextlib.py:82(__init__)
     1620    0.002    0.000    0.002    0.000 progress.py:126(increment_ready)
     1620    0.000    0.000    0.001    0.000 abc.py:96(__instancecheck__)
     1620    0.001    0.000    0.001    0.000 {built-in method _abc._abc_instancecheck}
     4860    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
     1620    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
     1620    0.000    0.000    0.000    0.000 base.py:54(trainer)
     1620    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}



Profile stats for: on_before_zero_grad
         72900 function calls in 0.022 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1620    0.005    0.000    0.017    0.000 callback_hook.py:309(on_before_zero_grad)
     4860    0.002    0.000    0.011    0.000 trainer.py:1668(lightning_module)
     4860    0.001    0.000    0.009    0.000 accelerator.py:172(lightning_module)
     4860    0.001    0.000    0.007    0.000 training_type_plugin.py:171(lightning_module)
     4860    0.002    0.000    0.006    0.000 base.py:104(unwrap_lightning_module)
     9720    0.002    0.000    0.004    0.000 {built-in method builtins.isinstance}
     1620    0.000    0.000    0.003    0.000 contextlib.py:117(__exit__)
     1620    0.000    0.000    0.002    0.000 {built-in method builtins.next}
     4860    0.001    0.000    0.002    0.000 abc.py:96(__instancecheck__)
     1620    0.001    0.000    0.002    0.000 base.py:68(profile)
     1620    0.001    0.000    0.001    0.000 advanced.py:66(stop)
     3240    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
     4860    0.001    0.000    0.001    0.000 {built-in method _abc._abc_instancecheck}
     6480    0.001    0.000    0.001    0.000 trainer.py:1593(accelerator)
     1620    0.000    0.000    0.001    0.000 trainer.py:1597(training_type_plugin)
     4860    0.001    0.000    0.001    0.000 base.py:329(on_before_zero_grad)
     3240    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
     1620    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
     1620    0.000    0.000    0.000    0.000 hooks.py:220(on_before_zero_grad)
     1620    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
     1620    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: backward
         59940 function calls in 1.590 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1620    0.003    0.000    1.590    0.001 optimizer_loop.py:326(backward_fn)
     1620    0.003    0.000    1.586    0.001 accelerator.py:302(backward)
     1620    0.003    0.000    1.578    0.001 precision_plugin.py:64(pre_backward)
     1620    0.003    0.000    1.575    0.001 trainer.py:1463(call_hook)
     1620    0.001    0.000    1.562    0.001 contextlib.py:108(__enter__)
     1620    0.000    0.000    1.561    0.001 {built-in method builtins.next}
     1620    0.001    0.000    1.561    0.001 base.py:68(profile)
     1620    0.001    0.000    1.560    0.001 advanced.py:61(start)
     1620    1.559    0.001    1.559    0.001 {method 'enable' of '_lsprof.Profiler' objects}
     3240    0.001    0.000    0.008    0.000 accelerator.py:172(lightning_module)
     3240    0.001    0.000    0.006    0.000 training_type_plugin.py:171(lightning_module)
     3240    0.002    0.000    0.005    0.000 base.py:104(unwrap_lightning_module)
     1620    0.003    0.000    0.004    0.000 module.py:1180(__setattr__)
     9720    0.002    0.000    0.004    0.000 {built-in method builtins.isinstance}
     1620    0.001    0.000    0.004    0.000 trainer.py:1668(lightning_module)
     1620    0.001    0.000    0.002    0.000 contextlib.py:238(helper)
     3240    0.001    0.000    0.002    0.000 abc.py:96(__instancecheck__)
     1620    0.001    0.000    0.001    0.000 contextlib.py:82(__init__)
     3240    0.001    0.000    0.001    0.000 {built-in method _abc._abc_instancecheck}
     3240    0.001    0.000    0.001    0.000 trainer.py:1593(accelerator)
     4860    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
     1620    0.000    0.000    0.000    0.000 base.py:54(trainer)
     1620    0.000    0.000    0.000    0.000 training_type_plugin.py:156(pre_backward)
     1620    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}



Profile stats for: on_before_backward
         72900 function calls in 0.020 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1620    0.004    0.000    0.015    0.000 callback_hook.py:294(on_before_backward)
     4860    0.002    0.000    0.011    0.000 trainer.py:1668(lightning_module)
     4860    0.001    0.000    0.008    0.000 accelerator.py:172(lightning_module)
     4860    0.001    0.000    0.007    0.000 training_type_plugin.py:171(lightning_module)
     4860    0.002    0.000    0.006    0.000 base.py:104(unwrap_lightning_module)
     9720    0.002    0.000    0.004    0.000 {built-in method builtins.isinstance}
     1620    0.000    0.000    0.002    0.000 contextlib.py:117(__exit__)
     1620    0.000    0.000    0.002    0.000 {built-in method builtins.next}
     4860    0.001    0.000    0.002    0.000 abc.py:96(__instancecheck__)
     1620    0.000    0.000    0.002    0.000 base.py:68(profile)
     1620    0.001    0.000    0.001    0.000 advanced.py:66(stop)
     3240    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
     4860    0.001    0.000    0.001    0.000 {built-in method _abc._abc_instancecheck}
     6480    0.001    0.000    0.001    0.000 trainer.py:1593(accelerator)
     1620    0.000    0.000    0.001    0.000 trainer.py:1597(training_type_plugin)
     4860    0.001    0.000    0.001    0.000 base.py:315(on_before_backward)
     3240    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
     1620    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
     1620    0.000    0.000    0.000    0.000 hooks.py:240(on_before_backward)
     1620    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
     1620    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: on_after_backward
         72900 function calls in 0.025 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1620    0.005    0.000    0.018    0.000 callback_hook.py:299(on_after_backward)
     4860    0.002    0.000    0.013    0.000 trainer.py:1668(lightning_module)
     4860    0.002    0.000    0.010    0.000 accelerator.py:172(lightning_module)
     4860    0.001    0.000    0.008    0.000 training_type_plugin.py:171(lightning_module)
     4860    0.002    0.000    0.007    0.000 base.py:104(unwrap_lightning_module)
     9720    0.002    0.000    0.004    0.000 {built-in method builtins.isinstance}
     1620    0.001    0.000    0.003    0.000 contextlib.py:117(__exit__)
     1620    0.000    0.000    0.003    0.000 {built-in method builtins.next}
     1620    0.001    0.000    0.002    0.000 base.py:68(profile)
     4860    0.001    0.000    0.002    0.000 abc.py:96(__instancecheck__)
     1620    0.001    0.000    0.002    0.000 advanced.py:66(stop)
     3240    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
     4860    0.001    0.000    0.001    0.000 {built-in method _abc._abc_instancecheck}
     6480    0.001    0.000    0.001    0.000 trainer.py:1593(accelerator)
     1620    0.000    0.000    0.001    0.000 trainer.py:1597(training_type_plugin)
     4860    0.001    0.000    0.001    0.000 base.py:319(on_after_backward)
     3240    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
     1620    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
     1620    0.000    0.000    0.000    0.000 hooks.py:248(on_after_backward)
     1620    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
     1620    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: on_before_optimizer_step
         72900 function calls in 0.021 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1620    0.003    0.000    0.015    0.000 callback_hook.py:304(on_before_optimizer_step)
     4860    0.002    0.000    0.011    0.000 trainer.py:1668(lightning_module)
     4860    0.001    0.000    0.008    0.000 accelerator.py:172(lightning_module)
     4860    0.001    0.000    0.007    0.000 training_type_plugin.py:171(lightning_module)
     4860    0.002    0.000    0.006    0.000 base.py:104(unwrap_lightning_module)
     9720    0.002    0.000    0.004    0.000 {built-in method builtins.isinstance}
     1620    0.000    0.000    0.002    0.000 contextlib.py:117(__exit__)
     3240    0.002    0.000    0.002    0.000 {built-in method builtins.getattr}
     1620    0.000    0.000    0.002    0.000 {built-in method builtins.next}
     4860    0.001    0.000    0.002    0.000 abc.py:96(__instancecheck__)
     1620    0.000    0.000    0.002    0.000 base.py:68(profile)
     1620    0.001    0.000    0.001    0.000 advanced.py:66(stop)
     4860    0.001    0.000    0.001    0.000 {built-in method _abc._abc_instancecheck}
     6480    0.001    0.000    0.001    0.000 trainer.py:1593(accelerator)
     1620    0.000    0.000    0.001    0.000 trainer.py:1597(training_type_plugin)
     4860    0.001    0.000    0.001    0.000 base.py:323(on_before_optimizer_step)
     1620    0.000    0.000    0.000    0.000 hooks.py:256(on_before_optimizer_step)
     1620    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
     3240    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
     1620    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
     1620    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_batch_end
         638280 function calls (633420 primitive calls) in 0.303 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1620    0.011    0.000    0.296    0.000 callback_hook.py:175(on_train_batch_end)
     4860    0.011    0.000    0.239    0.000 signature_utils.py:18(is_param_in_hook_signature)
     4860    0.003    0.000    0.227    0.000 inspect.py:3103(signature)
     4860    0.004    0.000    0.224    0.000 inspect.py:2851(from_callable)
9720/4860    0.024    0.000    0.220    0.000 inspect.py:2218(_signature_from_callable)
     4860    0.047    0.000    0.133    0.000 inspect.py:2124(_signature_from_function)
     9720    0.039    0.000    0.057    0.000 inspect.py:2772(__init__)
    32400    0.029    0.000    0.050    0.000 inspect.py:2489(__init__)
     4860    0.012    0.000    0.050    0.000 inspect.py:1812(_signature_bound_method)
     4860    0.004    0.000    0.036    0.000 inspect.py:2865(replace)
     1620    0.005    0.000    0.028    0.000 model_checkpoint.py:274(on_train_batch_end)
     1620    0.010    0.000    0.022    0.000 model_checkpoint.py:392(_should_skip_saving_checkpoint)
     4860    0.003    0.000    0.018    0.000 trainer.py:1668(lightning_module)
    32400    0.012    0.000    0.016    0.000 enum.py:313(__call__)
     4860    0.002    0.000    0.014    0.000 accelerator.py:172(lightning_module)
    72900    0.009    0.000    0.012    0.000 {built-in method builtins.isinstance}
     4860    0.002    0.000    0.011    0.000 training_type_plugin.py:171(lightning_module)
    37260    0.008    0.000    0.011    0.000 inspect.py:2821(<genexpr>)
     4860    0.006    0.000    0.010    0.000 inspect.py:493(unwrap)
     4860    0.003    0.000    0.009    0.000 base.py:104(unwrap_lightning_module)
     1620    0.002    0.000    0.008    0.000 trainer.py:2004(sanity_checking)
     1620    0.003    0.000    0.006    0.000 enums.py:30(__eq__)
    59940    0.005    0.000    0.005    0.000 inspect.py:2539(name)
     3240    0.002    0.000    0.005    0.000 trainer.py:2019(global_step)
    38880    0.005    0.000    0.005    0.000 {method 'get' of 'dict' objects}
    32400    0.004    0.000    0.004    0.000 enum.py:631(__new__)
     1620    0.001    0.000    0.004    0.000 contextlib.py:117(__exit__)
    32400    0.003    0.000    0.003    0.000 {method 'isidentifier' of 'str' objects}
     4860    0.001    0.000    0.003    0.000 abc.py:96(__instancecheck__)
    32400    0.003    0.000    0.003    0.000 {method 'append' of 'list' objects}
    37260    0.003    0.000    0.003    0.000 inspect.py:2551(kind)
     9720    0.002    0.000    0.003    0.000 inspect.py:158(isfunction)
     1620    0.000    0.000    0.003    0.000 {built-in method builtins.next}
     1620    0.001    0.000    0.002    0.000 base.py:68(profile)
    27540    0.002    0.000    0.002    0.000 inspect.py:2543(default)
     4860    0.002    0.000    0.002    0.000 inspect.py:513(_is_wrapper)
     3240    0.002    0.000    0.002    0.000 types.py:171(__get__)
     8100    0.002    0.000    0.002    0.000 {built-in method builtins.getattr}
     3240    0.002    0.000    0.002    0.000 fit_loop.py:65(global_step)
     4860    0.002    0.000    0.002    0.000 {built-in method _abc._abc_instancecheck}
     6480    0.002    0.000    0.002    0.000 trainer.py:1593(accelerator)
     1620    0.001    0.000    0.002    0.000 advanced.py:66(stop)
    12960    0.001    0.000    0.001    0.000 {built-in method builtins.callable}
     4860    0.001    0.000    0.001    0.000 {method 'values' of 'mappingproxy' objects}
     6480    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
     9720    0.001    0.000    0.001    0.000 inspect.py:2857(parameters)
     1620    0.001    0.000    0.001    0.000 trainer.py:1597(training_type_plugin)
     4860    0.001    0.000    0.001    0.000 {built-in method builtins.id}
     4860    0.001    0.000    0.001    0.000 {built-in method sys.getrecursionlimit}
     3240    0.001    0.000    0.001    0.000 enum.py:753(value)
     3240    0.001    0.000    0.001    0.000 {method 'lower' of 'str' objects}
     3240    0.001    0.000    0.001    0.000 base.py:110(on_train_batch_end)
     1620    0.001    0.000    0.001    0.000 {built-in method time.monotonic}
     3240    0.000    0.000    0.000    0.000 trainer.py:2047(fit_loop)
     3240    0.000    0.000    0.000    0.000 {built-in method builtins.len}
     1620    0.000    0.000    0.000    0.000 hooks.py:93(on_train_batch_end)
     1620    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_batch_end
         74520 function calls in 0.030 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1620    0.005    0.000    0.017    0.000 callback_hook.py:160(on_batch_end)
     4860    0.002    0.000    0.011    0.000 trainer.py:1668(lightning_module)
     3240    0.004    0.000    0.009    0.000 {built-in method builtins.getattr}
     4860    0.001    0.000    0.009    0.000 accelerator.py:172(lightning_module)
     4860    0.001    0.000    0.007    0.000 training_type_plugin.py:171(lightning_module)
     4860    0.002    0.000    0.006    0.000 base.py:104(unwrap_lightning_module)
     1620    0.003    0.000    0.006    0.000 module.py:1164(__getattr__)
     9720    0.002    0.000    0.004    0.000 {built-in method builtins.isinstance}
     1620    0.001    0.000    0.003    0.000 contextlib.py:117(__exit__)
     1620    0.003    0.000    0.003    0.000 {method 'format' of 'str' objects}
     1620    0.000    0.000    0.002    0.000 {built-in method builtins.next}
     4860    0.001    0.000    0.002    0.000 abc.py:96(__instancecheck__)
     1620    0.001    0.000    0.002    0.000 base.py:68(profile)
     1620    0.001    0.000    0.001    0.000 advanced.py:66(stop)
     4860    0.001    0.000    0.001    0.000 {built-in method _abc._abc_instancecheck}
     6480    0.001    0.000    0.001    0.000 trainer.py:1593(accelerator)
     1620    0.000    0.000    0.001    0.000 trainer.py:1597(training_type_plugin)
     4860    0.001    0.000    0.001    0.000 base.py:226(on_batch_end)
     1620    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
     3240    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
     1620    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
     1620    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_epoch_end
         978180 function calls (970780 primitive calls) in 1.661 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      180    0.001    0.000    1.659    0.009 callback_hook.py:90(on_train_epoch_end)
      180    0.003    0.000    1.656    0.009 model_checkpoint.py:305(on_train_epoch_end)
      180    0.001    0.000    1.651    0.009 model_checkpoint.py:362(save_checkpoint)
      180    0.001    0.000    1.530    0.009 model_checkpoint.py:676(_save_none_monitor_checkpoint)
      180    0.003    0.000    1.386    0.008 trainer.py:1900(save_checkpoint)
      180    0.001    0.000    1.383    0.008 checkpoint_connector.py:464(save_checkpoint)
      180    0.001    0.000    1.326    0.007 training_type_plugin.py:286(save_checkpoint)
      180    0.001    0.000    1.326    0.007 torch_plugin.py:32(save_checkpoint)
      180    0.004    0.000    1.312    0.007 cloud_io.py:50(atomic_save)
      180    0.006    0.000    0.860    0.005 serialization.py:333(save)
      180    0.381    0.002    0.848    0.005 serialization.py:457(_save)
      180    0.000    0.000    0.392    0.002 local.py:316(write)
      180    0.392    0.002    0.392    0.002 {method 'write' of '_io.BufferedWriter' objects}
     6480    0.006    0.000    0.312    0.000 storage.py:70(cpu)
     6480    0.016    0.000    0.305    0.000 __init__.py:613(type)
     6480    0.017    0.000    0.241    0.000 _utils.py:10(_type)
     6480    0.220    0.000    0.220    0.000 {method 'copy_' of 'torch._C.FloatStorageBase' objects}
      180    0.039    0.000    0.150    0.001 {method 'dump' of '_pickle.Pickler' objects}
      179    0.001    0.000    0.124    0.001 training_type_plugin.py:296(remove_checkpoint)
      179    0.002    0.000    0.123    0.001 torch_plugin.py:70(remove_checkpoint)
      179    0.001    0.000    0.109    0.001 local.py:137(rm)
      179    0.105    0.001    0.105    0.001 {built-in method posix.remove}
      360    0.000    0.000    0.084    0.000 trainer.py:2127(callback_metrics)
      360    0.001    0.000    0.084    0.000 logger_connector.py:333(callback_metrics)
      360    0.001    0.000    0.080    0.000 logger_connector.py:315(metrics)
      180    0.000    0.000    0.076    0.000 model_checkpoint.py:619(_validate_monitor_key)
      360    0.003    0.000    0.075    0.000 result.py:500(metrics)
   163800    0.040    0.000    0.072    0.000 serialization.py:461(persistent_id)
     1440    0.001    0.000    0.070    0.000 apply_func.py:66(apply_to_collection)
      720    0.001    0.000    0.067    0.000 result.py:469(_get_cache)
      180    0.000    0.000    0.064    0.000 result.py:243(wrapped_func)
      180    0.000    0.000    0.063    0.000 result.py:217(compute)
      180    0.001    0.000    0.063    0.000 metric.py:352(wrapped_func)
      180    0.001    0.000    0.059    0.000 accuracy.py:270(compute)
      180    0.005    0.000    0.058    0.000 accuracy.py:115(_accuracy_compute)
      180    0.002    0.000    0.056    0.000 checkpoint_connector.py:335(dump_checkpoint)
      180    0.016    0.000    0.051    0.000 stat_scores.py:183(_reduce_stat_scores)
      180    0.001    0.000    0.042    0.000 model_checkpoint.py:646(_monitor_candidates)
      180    0.001    0.000    0.042    0.000 checkpoint_connector.py:474(_get_lightning_module_state_dict)
      180    0.000    0.000    0.040    0.000 training_type_plugin.py:281(lightning_module_state_dict)
     6480    0.002    0.000    0.040    0.000 _tensor.py:131(__reduce_ex__)
 1800/180    0.006    0.000    0.039    0.000 module.py:1286(state_dict)
     6480    0.026    0.000    0.037    0.000 _tensor.py:152(_reduce_ex_internal)
  900/180    0.002    0.000    0.033    0.000 copy.py:128(deepcopy)
      180    0.001    0.000    0.032    0.000 copy.py:226(_deepcopy_dict)
      180    0.001    0.000    0.029    0.000 core.py:404(open)
      360    0.006    0.000    0.029    0.000 _tensor.py:81(__deepcopy__)
      180    0.001    0.000    0.028    0.000 core.py:219(open_files)
     6840    0.007    0.000    0.026    0.000 __init__.py:269(__enter__)
      180    0.000    0.000    0.025    0.000 __init__.py:328(state_dict_hook)
 1800/180    0.008    0.000    0.025    0.000 __init__.py:355(_recurse_update_dict)
     6840    0.005    0.000    0.022    0.000 __init__.py:265(__init__)
      180    0.000    0.000    0.018    0.000 model_checkpoint.py:634(_get_metric_interpolated_filepath_name)
   163800    0.017    0.000    0.017    0.000 __init__.py:291(is_storage)
     6840    0.009    0.000    0.017    0.000 _utils.py:7(_get_device_index)
      180    0.001    0.000    0.015    0.000 core.py:100(__enter__)
      720    0.015    0.000    0.015    0.000 {built-in method tensor}
      180    0.003    0.000    0.015    0.000 core.py:557(get_fs_token_paths)
      360    0.001    0.000    0.015    0.000 storage.py:44(__deepcopy__)
      180    0.001    0.000    0.015    0.000 spec.py:975(open)
      539    0.005    0.000    0.015    0.000 spec.py:61(__call__)
      360    0.001    0.000    0.014    0.000 local.py:45(makedirs)
      360    0.002    0.000    0.014    0.000 storage.py:60(clone)
     6840    0.004    0.000    0.014    0.000 __init__.py:477(current_device)
8460/5220    0.004    0.000    0.014    0.000 module.py:1653(named_modules)
      180    0.001    0.000    0.013    0.000 local.py:151(_open)
      360    0.002    0.000    0.013    0.000 os.py:198(makedirs)
   117287    0.011    0.000    0.013    0.000 {built-in method builtins.isinstance}
      193    0.001    0.000    0.012    0.000 model_checkpoint.py:536(format_checkpoint_name)
      180    0.001    0.000    0.012    0.000 local.py:240(__init__)
      551    0.003    0.000    0.011    0.000 local.py:65(info)
      180    0.000    0.000    0.011    0.000 local.py:252(_open)
      359    0.001    0.000    0.011    0.000 cloud_io.py:41(get_filesystem)
      180    0.011    0.000    0.011    0.000 {built-in method io.open}
     1271    0.010    0.000    0.010    0.000 {built-in method posix.stat}
      372    0.001    0.000    0.010    0.000 spec.py:574(exists)
      193    0.001    0.000    0.010    0.000 model_checkpoint.py:506(_format_checkpoint_name)
     6480    0.004    0.000    0.010    0.000 serialization.py:164(location_tag)
    14040    0.004    0.000    0.009    0.000 __init__.py:188(_lazy_init)
     1440    0.004    0.000    0.009    0.000 metric.py:560(__hash__)
      193    0.000    0.000    0.008    0.000 re.py:233(findall)
      180    0.000    0.000    0.008    0.000 core.py:297(<listcomp>)
      193    0.008    0.000    0.008    0.000 {method 'findall' of 're.Pattern' objects}
     1080    0.001    0.000    0.007    0.000 trainer.py:2139(_results)
      720    0.007    0.000    0.007    0.000 {built-in method where}
     1800    0.004    0.000    0.007    0.000 module.py:1249(_save_to_state_dict)
      180    0.002    0.000    0.007    0.000 version.py:261(__init__)
      539    0.003    0.000    0.006    0.000 utils.py:271(tokenize)
     1810    0.003    0.000    0.006    0.000 local.py:182(_strip_protocol)
      360    0.006    0.000    0.006    0.000 {method 'copy_' of 'torch._C.CudaFloatStorageBase' objects}
    14040    0.003    0.000    0.006    0.000 __init__.py:146(is_initialized)
      193    0.001    0.000    0.006    0.000 model_checkpoint.py:742(file_exists)
     2160    0.001    0.000    0.005    0.000 trainer.py:1945(training)
      180    0.000    0.000    0.005    0.000 accelerator.py:385(optimizer_state)
      180    0.000    0.000    0.005    0.000 core.py:121(__exit__)
      180    0.000    0.000    0.005    0.000 accelerator.py:390(<lambda>)
     6840    0.004    0.000    0.005    0.000 _utils.py:476(_get_device_index)
     2340    0.002    0.000    0.005    0.000 enums.py:30(__eq__)
     6480    0.003    0.000    0.005    0.000 serialization.py:121(_cuda_tag)
     3420    0.001    0.000    0.005    0.000 {method 'add' of 'set' objects}
      180    0.000    0.000    0.005    0.000 core.py:153(close)
      360    0.000    0.000    0.005    0.000 genericpath.py:16(exists)
      180    0.000    0.000    0.005    0.000 optimizer.py:96(state_dict)
      180    0.001    0.000    0.004    0.000 core.py:211(_close)
     1260    0.001    0.000    0.004    0.000 trainer.py:1668(lightning_module)
     6840    0.004    0.000    0.004    0.000 {built-in method torch._C._cuda_getDevice}
    22725    0.004    0.000    0.004    0.000 {built-in method builtins.getattr}
      360    0.004    0.000    0.004    0.000 {method 'float' of 'torch._C._TensorBase' objects}
      180    0.001    0.000    0.004    0.000 callback_hook.py:258(on_save_checkpoint)
     2520    0.004    0.000    0.004    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
     1080    0.001    0.000    0.003    0.000 trainer.py:2114(_active_loop)
     6480    0.002    0.000    0.003    0.000 _namedtensor_internals.py:10(check_serializing_named_tensor)
    13320    0.003    0.000    0.003    0.000 {method 'get_device' of 'torch._C.CudaFloatStorageBase' objects}
     1260    0.000    0.000    0.003    0.000 accelerator.py:172(lightning_module)
     1080    0.001    0.000    0.003    0.000 fit_loop.py:142(_results)
     1440    0.001    0.000    0.003    0.000 {built-in method builtins.hash}
     1260    0.002    0.000    0.003    0.000 enums.py:38(__eq__)
     1440    0.001    0.000    0.003    0.000 training_type_plugin.py:171(lightning_module)
      180    0.000    0.000    0.003    0.000 serialization.py:263(_open_zipfile_writer)
      360    0.003    0.000    0.003    0.000 {built-in method posix.mkdir}
      180    0.000    0.000    0.003    0.000 optimizer.py:118(<listcomp>)
      180    0.003    0.000    0.003    0.000 {method 'sum' of 'torch._C._TensorBase' objects}
      180    0.003    0.000    0.003    0.000 serialization.py:254(__init__)
      180    0.001    0.000    0.003    0.000 optimizer.py:110(pack_group)
     6840    0.003    0.000    0.003    0.000 {method 'size' of 'torch._C._TensorBase' objects}
     6300    0.002    0.000    0.003    0.000 types.py:171(__get__)
     1440    0.001    0.000    0.003    0.000 base.py:104(unwrap_lightning_module)
    14040    0.003    0.000    0.003    0.000 {built-in method torch._C._cuda_isInBadFork}
      540    0.000    0.000    0.003    0.000 {built-in method builtins.next}
    13320    0.003    0.000    0.003    0.000 {method 'size' of 'torch._C.CudaFloatStorageBase' objects}
     6480    0.002    0.000    0.002    0.000 serialization.py:183(normalize_storage_type)
      180    0.002    0.000    0.002    0.000 serialization.py:258(__exit__)
      360    0.000    0.000    0.002    0.000 imports.py:114(_fault_tolerant_training)
      179    0.000    0.000    0.002    0.000 spec.py:643(isdir)
  360/180    0.001    0.000    0.002    0.000 core.py:316(_un_chain)
     6840    0.002    0.000    0.002    0.000 {method 'storage' of 'torch._C._TensorBase' objects}
     5040    0.001    0.000    0.002    0.000 _tensor.py:650(__hash__)
      539    0.002    0.000    0.002    0.000 {built-in method _hashlib.openssl_md5}
     1810    0.002    0.000    0.002    0.000 local.py:200(make_path_posix)
      180    0.002    0.000    0.002    0.000 {built-in method ones_like}
      360    0.000    0.000    0.002    0.000 os.py:766(getenv)
      360    0.001    0.000    0.002    0.000 metric.py:504(state_dict)
      360    0.001    0.000    0.002    0.000 __init__.py:601(_lazy_new)
      180    0.002    0.000    0.002    0.000 {built-in method isnan}
      360    0.001    0.000    0.002    0.000 contextlib.py:117(__exit__)
     6840    0.002    0.000    0.002    0.000 __init__.py:278(__exit__)
      360    0.002    0.000    0.002    0.000 {method 'set_' of 'torch._C._TensorBase' objects}
     6840    0.002    0.000    0.002    0.000 {method 'stride' of 'torch._C._TensorBase' objects}
      360    0.002    0.000    0.002    0.000 {method 'new_empty' of 'torch._C._TensorBase' objects}
      180    0.000    0.000    0.002    0.000 core.py:318(<listcomp>)
      360    0.001    0.000    0.002    0.000 genericpath.py:39(isdir)
      180    0.001    0.000    0.002    0.000 model_checkpoint.py:392(_should_skip_saving_checkpoint)
      360    0.000    0.000    0.002    0.000 _collections_abc.py:657(get)
      360    0.001    0.000    0.002    0.000 posixpath.py:100(split)
      180    0.000    0.000    0.002    0.000 local.py:334(close)
      539    0.001    0.000    0.002    0.000 config.py:66(apply_config)
     6840    0.002    0.000    0.002    0.000 {method 'setdefault' of 'dict' objects}
    14040    0.002    0.000    0.002    0.000 _jit_internal.py:957(is_scripting)
      180    0.001    0.000    0.001    0.000 {method 'close' of '_io.BufferedWriter' objects}
     6480    0.001    0.000    0.001    0.000 serialization.py:116(_cpu_tag)
     6480    0.001    0.000    0.001    0.000 {method 'size' of 'torch._C.FloatStorageBase' objects}
     6480    0.001    0.000    0.001    0.000 {method 'data_ptr' of 'torch._C.FloatStorageBase' objects}
     2160    0.001    0.000    0.001    0.000 abc.py:96(__instancecheck__)
     6480    0.001    0.000    0.001    0.000 {method 'has_names' of 'torch._C._TensorBase' objects}
      180    0.000    0.000    0.001    0.000 model_checkpoint.py:248(state_key)
      373    0.001    0.000    0.001    0.000 re.py:289(_compile)
      180    0.001    0.000    0.001    0.000 version.py:444(_cmpkey)
      360    0.000    0.000    0.001    0.000 metric.py:317(sync_context)
      180    0.000    0.000    0.001    0.000 contextlib.py:108(__enter__)
     6480    0.001    0.000    0.001    0.000 hooks.py:54(warn_if_has_hooks)
      180    0.000    0.000    0.001    0.000 core.py:296(<setcomp>)
     1092    0.001    0.000    0.001    0.000 trainer.py:1597(training_type_plugin)
    17640    0.001    0.000    0.001    0.000 {built-in method builtins.id}
     6480    0.001    0.000    0.001    0.000 {method 'element_size' of 'torch._C.FloatStorageBase' objects}
      180    0.001    0.000    0.001    0.000 optimizer.py:120(<dictcomp>)
      539    0.001    0.000    0.001    0.000 {method 'hexdigest' of '_hashlib.HASH' objects}
      360    0.001    0.000    0.001    0.000 os.py:670(__getitem__)
      180    0.000    0.000    0.001    0.000 core.py:624(<listcomp>)
      180    0.000    0.000    0.001    0.000 metric.py:421(__setattr__)
     6840    0.001    0.000    0.001    0.000 {method 'storage_offset' of 'torch._C._TensorBase' objects}
      193    0.001    0.000    0.001    0.000 posixpath.py:71(join)
      540    0.001    0.000    0.001    0.000 {built-in method __new__ of type object at 0x908780}
      180    0.001    0.000    0.001    0.000 {method 'flush' of '_io._IOBase' objects}
      180    0.001    0.000    0.001    0.000 optimizer.py:113(<dictcomp>)
      180    0.001    0.000    0.001    0.000 {method 'search' of 're.Pattern' objects}
      180    0.001    0.000    0.001    0.000 registry.py:199(get_filesystem_class)
     6120    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
      539    0.001    0.000    0.001    0.000 {built-in method posix.getpid}
      180    0.001    0.000    0.001    0.000 core.py:520(expand_paths_if_needed)
     6480    0.001    0.000    0.001    0.000 _utils.py:82(_get_async_or_non_blocking)
      180    0.000    0.000    0.001    0.000 local.py:174(_parent)
     3814    0.001    0.000    0.001    0.000 {method 'startswith' of 'str' objects}
      180    0.000    0.000    0.001    0.000 base.py:51(_generate_state_key)
      180    0.001    0.000    0.001    0.000 core.py:299(<listcomp>)
8367/8360    0.001    0.000    0.001    0.000 {built-in method builtins.len}
      180    0.000    0.000    0.001    0.000 metric.py:259(sync)
      180    0.000    0.000    0.001    0.000 re.py:250(compile)
     3072    0.001    0.000    0.001    0.000 trainer.py:1593(accelerator)
     6840    0.001    0.000    0.001    0.000 storage.py:13(__init__)
     2170    0.001    0.000    0.001    0.000 utils.py:287(stringify_path)
      360    0.000    0.000    0.001    0.000 grad_mode.py:124(__enter__)
      360    0.000    0.000    0.001    0.000 result.py:64(should)
      180    0.001    0.000    0.001    0.000 posixpath.py:150(dirname)
      180    0.000    0.000    0.001    0.000 base.py:68(profile)
      720    0.001    0.000    0.001    0.000 grad_mode.py:213(__init__)
     1439    0.001    0.000    0.001    0.000 {method 'update' of 'dict' objects}
     2160    0.001    0.000    0.001    0.000 {built-in method _abc._abc_instancecheck}
     6300    0.001    0.000    0.001    0.000 enum.py:753(value)
      180    0.000    0.000    0.001    0.000 trainer.py:2004(sanity_checking)
      540    0.001    0.000    0.001    0.000 copy.py:242(_keep_alive)
      360    0.000    0.000    0.001    0.000 grad_mode.py:128(__exit__)
      360    0.001    0.000    0.001    0.000 grad_mode.py:119(__init__)
      360    0.000    0.000    0.001    0.000 apply_func.py:61(_is_dataclass_instance)
      180    0.000    0.000    0.001    0.000 trainer.py:1759(is_global_zero)
      180    0.000    0.000    0.001    0.000 version.py:432(_parse_local_version)
     7380    0.001    0.000    0.001    0.000 {method 'lower' of 'str' objects}
      180    0.001    0.000    0.001    0.000 module.py:1180(__setattr__)
      180    0.001    0.000    0.001    0.000 {built-in method builtins.repr}
      180    0.000    0.000    0.001    0.000 serialization.py:228(_open_file_like)
      180    0.000    0.000    0.001    0.000 metric.py:34(jit_distributed_available)
     8820    0.001    0.000    0.001    0.000 {method 'items' of 'collections.OrderedDict' objects}
      360    0.001    0.000    0.001    0.000 result.py:70(_generate_sync_fn)
      180    0.000    0.000    0.001    0.000 utils.py:98(update_storage_options)
     5839    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
      540    0.000    0.000    0.001    0.000 trainer.py:2023(current_epoch)
      180    0.001    0.000    0.001    0.000 {built-in method builtins.sorted}
      360    0.000    0.000    0.001    0.000 result.py:490(_forked_name)
      360    0.000    0.000    0.001    0.000 dataclasses.py:1045(is_dataclass)
     1080    0.000    0.000    0.001    0.000 result.py:488(<genexpr>)
      180    0.000    0.000    0.001    0.000 advanced.py:66(stop)
      180    0.000    0.000    0.001    0.000 optimizer.py:115(<listcomp>)
      180    0.000    0.000    0.001    0.000 trainer.py:1605(global_rank)
     5760    0.001    0.000    0.001    0.000 {built-in method torch._C._has_torch_function_unary}
      360    0.000    0.000    0.001    0.000 {built-in method builtins.all}
      360    0.000    0.000    0.000    0.000 typing_extensions.py:993(_dict_new)
     2527    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      179    0.000    0.000    0.000    0.000 __init__.py:1424(debug)
      360    0.000    0.000    0.000    0.000 os.py:748(encode)
      359    0.000    0.000    0.000    0.000 training_type_plugin.py:326(should_rank_save_checkpoint)
      720    0.000    0.000    0.000    0.000 version.py:271(<genexpr>)
     1800    0.000    0.000    0.000    0.000 {method 'group' of 're.Match' objects}
      193    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
      733    0.000    0.000    0.000    0.000 posixpath.py:41(_get_sep)
      540    0.000    0.000    0.000    0.000 trainer.py:2019(global_step)
      180    0.000    0.000    0.000    0.000 contextlib.py:238(helper)
      360    0.000    0.000    0.000    0.000 result.py:486(valid_items)
      180    0.000    0.000    0.000    0.000 local.py:348(__getattr__)
      360    0.000    0.000    0.000    0.000 serialization.py:193(_is_path)
      180    0.000    0.000    0.000    0.000 core.py:60(__init__)
     2709    0.000    0.000    0.000    0.000 {method 'rstrip' of 'str' objects}
      180    0.000    0.000    0.000    0.000 core.py:591(<listcomp>)
      180    0.000    0.000    0.000    0.000 core.py:170(__init__)
      360    0.000    0.000    0.000    0.000 _tensor.py:1001(grad)
      899    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
     2700    0.000    0.000    0.000    0.000 trainer.py:2047(fit_loop)
        2    0.000    0.000    0.000    0.000 sre_compile.py:759(compile)
      900    0.000    0.000    0.000    0.000 fit_loop.py:65(global_step)
     2702    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
      360    0.000    0.000    0.000    0.000 local.py:337(closed)
      746    0.000    0.000    0.000    0.000 {method 'replace' of 'str' objects}
      180    0.000    0.000    0.000    0.000 stat_scores.py:227(_get_final_stats)
      180    0.000    0.000    0.000    0.000 contextlib.py:82(__init__)
      180    0.000    0.000    0.000    0.000 optimizer.py:112(<dictcomp>)
      360    0.000    0.000    0.000    0.000 result.py:136(forked_name)
      360    0.000    0.000    0.000    0.000 version.py:437(<genexpr>)
     1080    0.000    0.000    0.000    0.000 {built-in method torch._C.is_grad_enabled}
      540    0.000    0.000    0.000    0.000 {method 'rfind' of 'str' objects}
      180    0.000    0.000    0.000    0.000 core.py:124(__del__)
      359    0.000    0.000    0.000    0.000 training_type_plugin.py:42(checkpoint_io)
      179    0.000    0.000    0.000    0.000 __init__.py:1689(isEnabledFor)
      180    0.000    0.000    0.000    0.000 trainer.py:2035(max_steps)
      540    0.000    0.000    0.000    0.000 result.py:121(sync)
      180    0.000    0.000    0.000    0.000 core.py:502(split_protocol)
      180    0.000    0.000    0.000    0.000 model_checkpoint.py:345(on_save_checkpoint)
        2    0.000    0.000    0.000    0.000 sre_parse.py:937(parse)
      543    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
      180    0.000    0.000    0.000    0.000 <string>:1(__new__)
      731    0.000    0.000    0.000    0.000 {built-in method _stat.S_ISDIR}
     1080    0.000    0.000    0.000    0.000 base.py:54(trainer)
      180    0.000    0.000    0.000    0.000 model_checkpoint.py:651(_save_last_checkpoint)
      181    0.000    0.000    0.000    0.000 registry.py:36(__contains__)
      540    0.000    0.000    0.000    0.000 fit_loop.py:55(current_epoch)
      180    0.000    0.000    0.000    0.000 serialization.py:314(_check_dill_version)
      180    0.000    0.000    0.000    0.000 __init__.py:8(is_available)
      180    0.000    0.000    0.000    0.000 {method 'split' of 're.Pattern' objects}
      180    0.000    0.000    0.000    0.000 hparams_mixin.py:127(hparams)
      3/2    0.000    0.000    0.000    0.000 sre_parse.py:435(_parse_sub)
      733    0.000    0.000    0.000    0.000 {built-in method posix.fspath}
      181    0.000    0.000    0.000    0.000 {method 'rsplit' of 'str' objects}
      360    0.000    0.000    0.000    0.000 core.py:494(get_compression)
      359    0.000    0.000    0.000    0.000 single_device.py:73(is_global_zero)
     1800    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
      3/2    0.000    0.000    0.000    0.000 sre_parse.py:493(_parse)
      360    0.000    0.000    0.000    0.000 serialization.py:199(__init__)
      360    0.000    0.000    0.000    0.000 {method 'getvalue' of '_io.BytesIO' objects}
      360    0.000    0.000    0.000    0.000 version.py:500(<genexpr>)
      180    0.000    0.000    0.000    0.000 serialization.py:224(__exit__)
      360    0.000    0.000    0.000    0.000 {method 'is_conj' of 'torch._C._TensorBase' objects}
      720    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
      371    0.000    0.000    0.000    0.000 {built-in method _stat.S_ISLNK}
      360    0.000    0.000    0.000    0.000 fit_loop.py:70(global_step)
      540    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
      360    0.000    0.000    0.000    0.000 apply_func.py:56(_is_namedtuple)
      539    0.000    0.000    0.000    0.000 spec.py:63(<genexpr>)
        2    0.000    0.000    0.000    0.000 sre_compile.py:598(_code)
      180    0.000    0.000    0.000    0.000 result.py:261(__setattr__)
      180    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}
      360    0.000    0.000    0.000    0.000 {method 'is_neg' of 'torch._C._TensorBase' objects}
      360    0.000    0.000    0.000    0.000 result.py:132(forked)
      719    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
      540    0.000    0.000    0.000    0.000 version.py:393(_parse_letter_version)
      180    0.000    0.000    0.000    0.000 trainer.py:1672(optimizers)
      180    0.000    0.000    0.000    0.000 {built-in method builtins.max}
      180    0.000    0.000    0.000    0.000 trainer.py:1685(lr_schedulers)
      180    0.000    0.000    0.000    0.000 distributed_c10d.py:386(is_initialized)
      360    0.000    0.000    0.000    0.000 core.py:617(<genexpr>)
      360    0.000    0.000    0.000    0.000 core.py:626(<genexpr>)
      180    0.000    0.000    0.000    0.000 model_checkpoint.py:663(_save_top_k_checkpoint)
      180    0.000    0.000    0.000    0.000 trainer.py:1601(precision_plugin)
      180    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
      540    0.000    0.000    0.000    0.000 result.py:60(should)
      360    0.000    0.000    0.000    0.000 version.py:459(<lambda>)
      7/2    0.000    0.000    0.000    0.000 sre_compile.py:71(_compile)
      180    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
      360    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}
      180    0.000    0.000    0.000    0.000 version.py:326(release)
      360    0.000    0.000    0.000    0.000 base.py:126(on_train_epoch_end)
      180    0.000    0.000    0.000    0.000 core.py:537(<listcomp>)
      360    0.000    0.000    0.000    0.000 base.py:283(on_save_checkpoint)
      371    0.000    0.000    0.000    0.000 {built-in method _stat.S_ISREG}
      360    0.000    0.000    0.000    0.000 result.py:515(any_tensor)
      360    0.000    0.000    0.000    0.000 hooks.py:802(on_save_checkpoint)
      180    0.000    0.000    0.000    0.000 registry.py:24(__getitem__)
      360    0.000    0.000    0.000    0.000 {method 'flush' of '_io.BytesIO' objects}
      180    0.000    0.000    0.000    0.000 fit_loop.py:102(max_steps)
      193    0.000    0.000    0.000    0.000 {method 'endswith' of 'str' objects}
      360    0.000    0.000    0.000    0.000 copy.py:182(_deepcopy_atomic)
      180    0.000    0.000    0.000    0.000 spec.py:164(_fs_token)
      180    0.000    0.000    0.000    0.000 hooks.py:193(on_train_epoch_end)
      360    0.000    0.000    0.000    0.000 {method 'clear' of 'list' objects}
        1    0.000    0.000    0.000    0.000 registry.py:229(_import_class)
      360    0.000    0.000    0.000    0.000 serialization.py:202(__enter__)
      180    0.000    0.000    0.000    0.000 {method 'isdigit' of 'str' objects}
      180    0.000    0.000    0.000    0.000 metric.py:295(unsync)
      180    0.000    0.000    0.000    0.000 {method 'keys' of 'dict' objects}
      180    0.000    0.000    0.000    0.000 utilities.py:173(_is_max_limit_reached)
      180    0.000    0.000    0.000    0.000 spec.py:199(_get_kwargs_from_urls)
        2    0.000    0.000    0.000    0.000 sre_compile.py:536(_compile_info)
        1    0.000    0.000    0.000    0.000 __init__.py:109(import_module)
      193    0.000    0.000    0.000    0.000 single_device.py:80(broadcast)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:1002(_gcd_import)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:986(_find_and_load)
        2    0.000    0.000    0.000    0.000 sre_compile.py:276(_optimize_charset)
       38    0.000    0.000    0.000    0.000 sre_parse.py:164(__getitem__)
      8/3    0.000    0.000    0.000    0.000 sre_parse.py:174(getwidth)
        2    0.000    0.000    0.000    0.000 enum.py:938(__and__)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:147(__enter__)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:157(_get_module_lock)
       17    0.000    0.000    0.000    0.000 sre_parse.py:254(get)
        2    0.000    0.000    0.000    0.000 sre_parse.py:224(__init__)
       23    0.000    0.000    0.000    0.000 sre_parse.py:233(__next)
      3/2    0.000    0.000    0.000    0.000 sre_compile.py:461(_get_literal_prefix)
        1    0.000    0.000    0.000    0.000 sre_parse.py:355(_escape)
        1    0.000    0.000    0.000    0.000 sre_parse.py:96(closegroup)
       10    0.000    0.000    0.000    0.000 sre_parse.py:286(tell)
        4    0.000    0.000    0.000    0.000 sre_compile.py:423(_simple)
        2    0.000    0.000    0.000    0.000 sre_parse.py:432(_uniq)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:194(_lock_unlock_module)
        4    0.000    0.000    0.000    0.000 enum.py:313(__call__)
        1    0.000    0.000    0.000    0.000 sre_parse.py:84(opengroup)
        1    0.000    0.000    0.000    0.000 __init__.py:1675(getEffectiveLevel)
       15    0.000    0.000    0.000    0.000 sre_parse.py:160(__len__)
        1    0.000    0.000    0.000    0.000 registry.py:43(register_implementation)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:58(__init__)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:78(acquire)
       16    0.000    0.000    0.000    0.000 {built-in method builtins.min}
       14    0.000    0.000    0.000    0.000 sre_parse.py:249(match)
       13    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
        1    0.000    0.000    0.000    0.000 __init__.py:218(_acquireLock)
        2    0.000    0.000    0.000    0.000 sre_compile.py:249(_compile_charset)
        2    0.000    0.000    0.000    0.000 sre_parse.py:76(__init__)
        7    0.000    0.000    0.000    0.000 sre_parse.py:172(append)
        7    0.000    0.000    0.000    0.000 sre_parse.py:111(__init__)
        8    0.000    0.000    0.000    0.000 {method 'find' of 'bytearray' objects}
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:151(__exit__)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:176(cb)
        2    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:103(release)
        1    0.000    0.000    0.000    0.000 sre_parse.py:295(_class_escape)
        2    0.000    0.000    0.000    0.000 {built-in method _sre.compile}
        4    0.000    0.000    0.000    0.000 enum.py:631(__new__)
        2    0.000    0.000    0.000    0.000 sre_parse.py:921(fix_flags)
        6    0.000    0.000    0.000    0.000 sre_parse.py:81(groups)
        4    0.000    0.000    0.000    0.000 sre_compile.py:595(isstring)
        1    0.000    0.000    0.000    0.000 __init__.py:227(_releaseLock)
        1    0.000    0.000    0.000    0.000 sre_compile.py:432(_generate_overlap_table)
        2    0.000    0.000    0.000    0.000 {built-in method fromkeys}
        1    0.000    0.000    0.000    0.000 sre_compile.py:492(_get_charset_prefix)
        4    0.000    0.000    0.000    0.000 sre_parse.py:168(__setitem__)
        1    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:937(_sanity_check)
        4    0.000    0.000    0.000    0.000 sre_compile.py:453(_get_iscased)
        2    0.000    0.000    0.000    0.000 sre_compile.py:65(_combine_flags)
        1    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:143(__init__)
        4    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
        4    0.000    0.000    0.000    0.000 {built-in method _imp.acquire_lock}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.ord}
        1    0.000    0.000    0.000    0.000 __init__.py:1276(disable)
        4    0.000    0.000    0.000    0.000 {built-in method _imp.release_lock}
        1    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 {method 'insert' of 'list' objects}
        3    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}



Profile stats for: on_epoch_end
         8100 function calls in 0.003 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      180    0.001    0.000    0.002    0.000 callback_hook.py:130(on_epoch_end)
      540    0.000    0.000    0.002    0.000 trainer.py:1668(lightning_module)
      540    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
      540    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
      540    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
     1080    0.000    0.000    0.001    0.000 {built-in method builtins.isinstance}
      180    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
      180    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      180    0.000    0.000    0.000    0.000 base.py:68(profile)
      540    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)
      180    0.000    0.000    0.000    0.000 advanced.py:66(stop)
      180    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      720    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
      540    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
      360    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      180    0.000    0.000    0.000    0.000 trainer.py:1597(training_type_plugin)
      540    0.000    0.000    0.000    0.000 base.py:164(on_epoch_end)
      360    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
      180    0.000    0.000    0.000    0.000 hooks.py:187(on_epoch_end)
      180    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      180    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_end
         62 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:140(on_train_end)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:329(on_train_end)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:392(_should_skip_saving_checkpoint)
        3    0.000    0.000    0.000    0.000 trainer.py:1668(lightning_module)
        3    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:2004(sanity_checking)
        3    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 enums.py:30(__eq__)
        7    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        3    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 types.py:171(__get__)
        1    0.000    0.000    0.000    0.000 trainer.py:2019(global_step)
        2    0.000    0.000    0.000    0.000 trainer.py:1597(training_type_plugin)
        5    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        2    0.000    0.000    0.000    0.000 enum.py:753(value)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 fit_loop.py:65(global_step)
        2    0.000    0.000    0.000    0.000 base.py:234(on_train_end)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:347(on_train_end)
        1    0.000    0.000    0.000    0.000 hooks.py:43(on_train_end)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:2047(fit_loop)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_fit_end
         45 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:70(on_fit_end)
        3    0.000    0.000    0.000    0.000 trainer.py:1668(lightning_module)
        3    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        3    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        3    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        4    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1597(training_type_plugin)
        3    0.000    0.000    0.000    0.000 base.py:87(on_fit_end)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:34(on_fit_end)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: teardown
         42 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:50(teardown)
        3    0.000    0.000    0.000    0.000 trainer.py:1668(lightning_module)
        3    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        3    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:117(__exit__)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        3    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        3    0.000    0.000    0.000    0.000 trainer.py:1593(accelerator)
        3    0.000    0.000    0.000    0.000 base.py:71(teardown)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:399(teardown)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



End Iteration 0 in 60.11797046661377 seconds 

